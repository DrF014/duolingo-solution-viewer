!function(){"use strict";const e=()=>{},t=e=>"string"==typeof e,n=Array.isArray,a=e=>"object"==typeof e&&!!e&&!n(e),l=e=>"function"==typeof e,o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),s=e=>{for(let t in e)if(o(e,t))return!1;return!0},r=e=>{let t=null;if("/"===e.charAt(0)&&("/"===e.charAt(1)?e="https://"+e:t=e),null===t)try{t=new URL(e).pathname}catch(n){t=e}return t},i=e=>"__duo-toolbox__-"+e,d=i("global_variables"),u=(e,t)=>(a(window[d])||(window[d]={}),o(window[d],e)?window[d][e]:t),c=(e,t)=>{a(window[d])||(window[d]={}),window[d][e]=t},p=(e,t,n)=>{const a=t(u(e,n));return c(e,a),a},v=i("original_function"),g=i("override_version"),f=(t,n,s,r=1)=>((e,t,n,a,l=1)=>{o(window,e)&&t(window[e])?n(window[e]):p("pending_global_listeners",(o={})=>{var s;if(!o[e]){o[e]={};let n=window[e];Object.defineProperty(window,e,{get:()=>n,set:a=>{t(a)?(Object.defineProperty(window,e,{value:a,configurable:!0,enumerable:!0,writable:!0}),Object.values(o[e]).forEach(e=>e.callback(a))):n=a},configurable:!0})}return l>(Number(null===(s=o[e][a])||void 0===s?void 0:s.version)||0)&&(o[e][a]={callback:n,version:l}),o})})(t,l,t=>((t,n,l,o=1)=>{var s;if(a(t)&&o>(Number(null===(s=t[n])||void 0===s?void 0:s[g])||0)){var r;const a=(null===(r=t[n])||void 0===r?void 0:r[v])||t[n]||e;t[n]=l(a),t[n][v]=a,t[n][g]=o}})(null==t?void 0:t.prototype,n,s,r),"instance_method:"+n,r),_=i("logging_iframe"),m=i("ui_event_notification"),h=(e,t)=>{window.postMessage({type:m,event:e,value:t},"*")},w=()=>(()=>{let e=document.getElementById(_);return e&&e.isConnected||(e=document.createElement("iframe"),e.id=_,e.style.display="none",document.body.appendChild(e)),e})().contentWindow.console,y=(...e)=>w().error(...e),b=e=>{var t,n;return(null===(t=e.metadata)||void 0===t?void 0:t.source_language)||e.sourceLanguage||(null===(n=e.metadata)||void 0===n?void 0:n.learning_language)},k=e=>{var t;return(null===(t=e.metadata)||void 0===t?void 0:t.target_language)||e.targetLanguage||b(e)},O="tts_sentence",j="tts_word",T="normal",C="event_listeners",E=()=>{return`__listener::${e="last_event_listener_id",p(`__counter::${e}__`,e=>e+1,0)}__`;var e},L=e=>{var t;return(null===(t=u(C,{}))||void 0===t?void 0:t[e])||{}},$=(e,t)=>{p(C,n=>Object.assign(n||{},{[e]:t}))},S=!s(e=>L(e)),x=(e,t)=>{const n=L(e);return s(n)?null:t(Object.values(n))},M=(e,t,n=E())=>{const a=L(e);return a[n]=t,$(e,a),()=>A(e,n)},q=(e,t,a,l,o=M,s=E())=>{const r=`__${t}::${e}__`;var i;i=r,L(t)[i]||o(t,(...t)=>{const a=l(...t);n(a)&&I(e,...a)},r);const d=M(e,a,s);return()=>{d(),S(e)||A(t,r)}},A=(e,t)=>{const n=L(e);delete n[t],$(e,n)},I=(e,...t)=>x(e,e=>e.flatMap(e=>{try{return[e(...t)]}catch(e){return[]}})),N="practice_session_loaded",P="story_loaded",H="forum_discussion_loaded",R="dictionary_lexeme_loaded",z="sound_playback_requested",X="sound_playback_confirmed",B="sound_playback_cancelled",D={[R]:/\/api\/1\/dictionary_page/g,[H]:/\/comments\/([\d]+)/g,[N]:/\/[\d]{4}-[\d]{2}-[\d]{2}\/sessions/g,[P]:/\/api2\/stories/g,user_data_loaded:/\/[\d]{4}-[\d]{2}-[\d]{2}\/users\/[\d]+/g},J=(e,t,n=E())=>(f("XMLHttpRequest","open",e=>function(t,n,l,o,s){let r;for(const[e,t]of Object.entries(D))if(n.match(t)){r=e;break}return r&&x(r,e=>{this.addEventListener("load",()=>{try{const t=a(this.response)?this.response:JSON.parse(this.responseText);e.forEach(e=>e(t))}catch(e){y(e,`Could not handle the XHR result (event: ${r}): `)}})}),e.call(this,t,n,l,o,s)}),M(e,t,n)),U=e=>J(H,e),W=e=>q("practice_challenges_loaded",N,e,e=>{let t;if(a(e)){var l;t=[{challenges:[e.challenges,e.adaptiveChallenges,null===(l=e.adaptiveInterleavedChallenges)||void 0===l?void 0:l.challenges].filter(n).flat(),sessionMetaData:e.metadata||{}}]}return t},J),F=(e,t)=>({url:e,type:O,speed:T,language:t}),G=(e,t)=>({url:e,type:j,speed:T,language:t}),K=Object.fromEntries(["/sounds/7abe057dc8446ad325229edd6d8fd250.mp3","/sounds/2aae0ea735c8e9ed884107d6f0a09e35.mp3","/sounds/421d48c53ad6d52618dba715722278e0.mp3","/sounds/37d8f0b39dcfe63872192c89653a93f6.mp3","/sounds/0a27c1ee63dd220647e8410a0029aed2.mp3","/sounds/a28ff0a501ef5f33ca78c0afc45ee53e.mp3","/sounds/2e4669d8cf839272f0731f8afa488caf.mp3","/sounds/f0b6ab4396d5891241ef4ca73b4de13a.mp3"].map(e=>{return[e,(t=e,{url:t,type:"effect",speed:T,language:null})];var t})),Q=/\/duolingo-data\/tts\/(?<language>[a-z-_]+)\/token\//i,V="sound_type_map",Y=()=>u(V,K),Z=e=>{const t=Y()||{};for(const n of e)t[r(n.url)]=n;c(V,t)},ee="sound_detection_unregistration_callbacks",te=(e,t,n)=>({url:e.url,type:t,speed:(null==e?void 0:e.speed.value)||T,language:n}),ne=()=>{var e,l;u(ee)||c(ee,[(l=e=>(e=>{const a=e.learningLanguage;n(e.elements)&&Z(e.elements.map(e=>{var t;return(null==e||null===(t=e.line)||void 0===t?void 0:t.content)||(null==e?void 0:e.learningLanguageTitleContent)}).flatMap(e=>[null==e?void 0:e.audio,null==e?void 0:e.audioPrefix,null==e?void 0:e.audioSuffix]).map(e=>null==e?void 0:e.url).filter(t).map(e=>F(e,a)))})(e),J(P,l)),U(e=>{var n;t((n=e).tts_url)&&Z([F(n.tts_url,n.sentence_language)])}),(e=e=>(e=>{const a=[],l=e.learning_language;t(e.tts)&&a.push(G(e.tts,l)),n(e.alternative_forms)&&a.push(e.alternative_forms.map(e=>null==e?void 0:e.tts).filter(t).map(e=>F(e,l))),Z(a.flat())})(e),J(R,e)),W(e=>(e=>{const l=[];for(const i of e){var o;const e=b(i),d=k(i);if(t(i.tts)&&l.push(F(i.tts,e)),t(i.slowTts)&&l.push({url:i.slowTts,type:O,speed:"slow",language:e}),t(i.solutionTts)&&l.push(F(i.solutionTts,d)),n(i.choices)&&l.push(i.choices.map(e=>null==e?void 0:e.tts).filter(t).map(e=>G(e,d))),n(i.tokens)&&l.push(i.tokens.map(e=>null==e?void 0:e.tts).filter(t).map(t=>G(t,e))),n(i.questionTokens)&&l.push(i.questionTokens.map(e=>null==e?void 0:e.tts).filter(t).map(e=>G(e,d))),n(null===(o=i.metadata)||void 0===o?void 0:o.speakers))for(const e of i.metadata.speakers){var s,r;a(null===(s=e.tts)||void 0===s?void 0:s.tokens)&&l.push(Object.values(e.tts.tokens).filter(e=>t(e.url)).map(e=>te(e,j,d))),n(null===(r=e.tts)||void 0===r?void 0:r.sentence)&&l.push(e.tts.sentence.filter(e=>t(e.url)).map(e=>te(e,O,d)))}n(i.pairs)&&l.push(i.pairs.map(e=>null==e?void 0:e.tts).filter(t).map(e=>G(e,d)))}Z(l.flat())})(e.challenges))])},ae=(e,t,n)=>{const l=(e=>{const t=Y()[e];if(a(t))return t;const n=e.match(Q);return n?G(e,n.language):null})(r(t));return{url:t,type:(null==l?void 0:l.type)||"unknown",speed:(null==l?void 0:l.speed)||T,language:null==l?void 0:l.language,playbackStrategy:n,sound:e}},le=(e,t)=>{f("Howl","play",e=>function(t){var n;c("is_howler_used",!0);const a=String(this._src||(null===(n=this._parent)||void 0===n?void 0:n._src)||"").trim();return""!==a?((e,t,n,a)=>{const l=ae(e,t,n);let o=!1;try{var s;o=null===(s=I(z,l))||void 0===s?void 0:s.some(e=>!1===e),I(o?B:X,l)}catch(e){y(e,`Could not handle playback for sound "${t}" (using "${n}"): `)}return o?null:a()})(this,a,"howler",()=>e.call(this,t)):e.call(this,t)}),ne();const a=M(e,t);return()=>{a(),(()=>{const e=u(ee);!n(e)||S("sound_initialized")||S(z)||S(B)||S(X)||(e.forEach(e=>e()),c(ee,null))})()}};W(e=>h("session_loaded",e)),U(e=>{e.id>0&&e.sentence_id&&e.translation_language&&h("discussion_loaded",{commentId:Number(e.id),discussionId:String(e.sentence_id).trim(),locale:String(e.translation_language).trim()})}),le(z,e=>h("sound_played",null==e?void 0:e.url))}();
