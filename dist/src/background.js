!function(){"use strict";var e="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function n(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function t(e,n,t){return e(t={path:n,exports:{},require:function(e,n){return function(){throw new Error("Dynamic requires are not currently supported by @rollup/plugin-commonjs")}(null==n&&t.path)}},t.exports),t.exports}var r,i,o=function(e){return e&&e.Math==Math&&e},a=o("object"==typeof globalThis&&globalThis)||o("object"==typeof window&&window)||o("object"==typeof self&&self)||o("object"==typeof e&&e)||function(){return this}()||Function("return this")(),u=function(e){try{return!!e()}catch(e){return!0}},s=!u((function(){return 7!=Object.defineProperty({},1,{get:function(){return 7}})[1]})),c={}.propertyIsEnumerable,l=Object.getOwnPropertyDescriptor,f={f:l&&!c.call({1:2},1)?function(e){var n=l(this,e);return!!n&&n.enumerable}:c},h=function(e,n){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:n}},p={}.toString,d=function(e){return p.call(e).slice(8,-1)},v="".split,y=u((function(){return!Object("z").propertyIsEnumerable(0)}))?function(e){return"String"==d(e)?v.call(e,""):Object(e)}:Object,g=function(e){if(null==e)throw TypeError("Can't call method on "+e);return e},m=function(e){return y(g(e))},b=function(e){return"object"==typeof e?null!==e:"function"==typeof e},w=function(e){return"function"==typeof e?e:void 0},_=function(e,n){return arguments.length<2?w(a[e]):a[e]&&a[e][n]},x=_("navigator","userAgent")||"",k=a.process,S=a.Deno,O=k&&k.versions||S&&S.version,C=O&&O.v8;C?i=(r=C.split("."))[0]<4?1:r[0]+r[1]:x&&(!(r=x.match(/Edge\/(\d+)/))||r[1]>=74)&&(r=x.match(/Chrome\/(\d+)/))&&(i=r[1]);var E=i&&+i,A=!!Object.getOwnPropertySymbols&&!u((function(){var e=Symbol();return!String(e)||!(Object(e)instanceof Symbol)||!Symbol.sham&&E&&E<41})),j=A&&!Symbol.sham&&"symbol"==typeof Symbol.iterator,P=j?function(e){return"symbol"==typeof e}:function(e){var n=_("Symbol");return"function"==typeof n&&Object(e)instanceof n},I=function(e,n){try{Object.defineProperty(a,e,{value:n,configurable:!0,writable:!0})}catch(t){a[e]=n}return n},T="__core-js_shared__",M=a[T]||I(T,{}),R=t((function(e){(e.exports=function(e,n){return M[e]||(M[e]=void 0!==n?n:{})})("versions",[]).push({version:"3.16.0",mode:"global",copyright:"Â© 2021 Denis Pushkarev (zloirock.ru)"})})),K=function(e){return Object(g(e))},D={}.hasOwnProperty,F=Object.hasOwn||function(e,n){return D.call(K(e),n)},N=0,z=Math.random(),L=function(e){return"Symbol("+String(void 0===e?"":e)+")_"+(++N+z).toString(36)},B=R("wks"),q=a.Symbol,H=j?q:q&&q.withoutSetter||L,U=function(e){return F(B,e)&&(A||"string"==typeof B[e])||(A&&F(q,e)?B[e]=q[e]:B[e]=H("Symbol."+e)),B[e]},$=U("toPrimitive"),W=function(e,n){if(!b(e)||P(e))return e;var t,r=e[$];if(void 0!==r){if(void 0===n&&(n="default"),t=r.call(e,n),!b(t)||P(t))return t;throw TypeError("Can't convert object to primitive value")}return void 0===n&&(n="number"),function(e,n){var t,r;if("string"===n&&"function"==typeof(t=e.toString)&&!b(r=t.call(e)))return r;if("function"==typeof(t=e.valueOf)&&!b(r=t.call(e)))return r;if("string"!==n&&"function"==typeof(t=e.toString)&&!b(r=t.call(e)))return r;throw TypeError("Can't convert object to primitive value")}(e,n)},V=function(e){var n=W(e,"string");return P(n)?n:String(n)},Y=a.document,G=b(Y)&&b(Y.createElement),J=function(e){return G?Y.createElement(e):{}},Q=!s&&!u((function(){return 7!=Object.defineProperty(J("div"),"a",{get:function(){return 7}}).a})),X=Object.getOwnPropertyDescriptor,Z={f:s?X:function(e,n){if(e=m(e),n=V(n),Q)try{return X(e,n)}catch(e){}if(F(e,n))return h(!f.f.call(e,n),e[n])}},ee=function(e){if(!b(e))throw TypeError(String(e)+" is not an object");return e},ne=Object.defineProperty,te={f:s?ne:function(e,n,t){if(ee(e),n=V(n),ee(t),Q)try{return ne(e,n,t)}catch(e){}if("get"in t||"set"in t)throw TypeError("Accessors not supported");return"value"in t&&(e[n]=t.value),e}},re=s?function(e,n,t){return te.f(e,n,h(1,t))}:function(e,n,t){return e[n]=t,e},ie=Function.toString;"function"!=typeof M.inspectSource&&(M.inspectSource=function(e){return ie.call(e)});var oe,ae,ue,se=M.inspectSource,ce=a.WeakMap,le="function"==typeof ce&&/native code/.test(se(ce)),fe=R("keys"),he=function(e){return fe[e]||(fe[e]=L(e))},pe={},de="Object already initialized",ve=a.WeakMap;if(le||M.state){var ye=M.state||(M.state=new ve),ge=ye.get,me=ye.has,be=ye.set;oe=function(e,n){if(me.call(ye,e))throw new TypeError(de);return n.facade=e,be.call(ye,e,n),n},ae=function(e){return ge.call(ye,e)||{}},ue=function(e){return me.call(ye,e)}}else{var we=he("state");pe[we]=!0,oe=function(e,n){if(F(e,we))throw new TypeError(de);return n.facade=e,re(e,we,n),n},ae=function(e){return F(e,we)?e[we]:{}},ue=function(e){return F(e,we)}}var _e={set:oe,get:ae,has:ue,enforce:function(e){return ue(e)?ae(e):oe(e,{})},getterFor:function(e){return function(n){var t;if(!b(n)||(t=ae(n)).type!==e)throw TypeError("Incompatible receiver, "+e+" required");return t}}},xe=t((function(e){var n=_e.get,t=_e.enforce,r=String(String).split("String");(e.exports=function(e,n,i,o){var u,s=!!o&&!!o.unsafe,c=!!o&&!!o.enumerable,l=!!o&&!!o.noTargetGet;"function"==typeof i&&("string"!=typeof n||F(i,"name")||re(i,"name",n),(u=t(i)).source||(u.source=r.join("string"==typeof n?n:""))),e!==a?(s?!l&&e[n]&&(c=!0):delete e[n],c?e[n]=i:re(e,n,i)):c?e[n]=i:I(n,i)})(Function.prototype,"toString",(function(){return"function"==typeof this&&n(this).source||se(this)}))})),ke=Math.ceil,Se=Math.floor,Oe=function(e){return isNaN(e=+e)?0:(e>0?Se:ke)(e)},Ce=Math.min,Ee=function(e){return e>0?Ce(Oe(e),9007199254740991):0},Ae=Math.max,je=Math.min,Pe=function(e){return function(n,t,r){var i,o=m(n),a=Ee(o.length),u=function(e,n){var t=Oe(e);return t<0?Ae(t+n,0):je(t,n)}(r,a);if(e&&t!=t){for(;a>u;)if((i=o[u++])!=i)return!0}else for(;a>u;u++)if((e||u in o)&&o[u]===t)return e||u||0;return!e&&-1}},Ie={includes:Pe(!0),indexOf:Pe(!1)}.indexOf,Te=function(e,n){var t,r=m(e),i=0,o=[];for(t in r)!F(pe,t)&&F(r,t)&&o.push(t);for(;n.length>i;)F(r,t=n[i++])&&(~Ie(o,t)||o.push(t));return o},Me=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],Re=Me.concat("length","prototype"),Ke={f:Object.getOwnPropertyNames||function(e){return Te(e,Re)}},De={f:Object.getOwnPropertySymbols},Fe=_("Reflect","ownKeys")||function(e){var n=Ke.f(ee(e)),t=De.f;return t?n.concat(t(e)):n},Ne=function(e,n){for(var t=Fe(n),r=te.f,i=Z.f,o=0;o<t.length;o++){var a=t[o];F(e,a)||r(e,a,i(n,a))}},ze=/#|\.prototype\./,Le=function(e,n){var t=qe[Be(e)];return t==Ue||t!=He&&("function"==typeof n?u(n):!!n)},Be=Le.normalize=function(e){return String(e).replace(ze,".").toLowerCase()},qe=Le.data={},He=Le.NATIVE="N",Ue=Le.POLYFILL="P",$e=Le,We=Z.f,Ve=function(e,n){var t,r,i,o,u,s=e.target,c=e.global,l=e.stat;if(t=c?a:l?a[s]||I(s,{}):(a[s]||{}).prototype)for(r in n){if(o=n[r],i=e.noTargetGet?(u=We(t,r))&&u.value:t[r],!$e(c?r:s+(l?".":"#")+r,e.forced)&&void 0!==i){if(typeof o==typeof i)continue;Ne(o,i)}(e.sham||i&&i.sham)&&re(o,"sham",!0),xe(t,r,o,e)}},Ye=Array.isArray||function(e){return"Array"==d(e)},Ge=function(e){if("function"!=typeof e)throw TypeError(String(e)+" is not a function");return e},Je=function(e,n,t){if(Ge(e),void 0===n)return e;switch(t){case 0:return function(){return e.call(n)};case 1:return function(t){return e.call(n,t)};case 2:return function(t,r){return e.call(n,t,r)};case 3:return function(t,r,i){return e.call(n,t,r,i)}}return function(){return e.apply(n,arguments)}},Qe=function(e,n,t,r,i,o,a,u){for(var s,c=i,l=0,f=!!a&&Je(a,u,3);l<r;){if(l in t){if(s=f?f(t[l],l,n):t[l],o>0&&Ye(s))c=Qe(e,n,s,Ee(s.length),c,o-1)-1;else{if(c>=9007199254740991)throw TypeError("Exceed the acceptable array length");e[c]=s}c++}l++}return c},Xe=Qe,Ze=U("species"),en=function(e,n){return new(function(e){var n;return Ye(e)&&("function"!=typeof(n=e.constructor)||n!==Array&&!Ye(n.prototype)?b(n)&&null===(n=n[Ze])&&(n=void 0):n=void 0),void 0===n?Array:n}(e))(0===n?0:n)};Ve({target:"Array",proto:!0},{flatMap:function(e){var n,t=K(this),r=Ee(t.length);return Ge(e),(n=en(t,0)).length=Xe(n,t,t,r,0,1,e,arguments.length>1?arguments[1]:void 0),n}});var nn,tn=Object.keys||function(e){return Te(e,Me)},rn=s?Object.defineProperties:function(e,n){ee(e);for(var t,r=tn(n),i=r.length,o=0;i>o;)te.f(e,t=r[o++],n[t]);return e},on=_("document","documentElement"),an=he("IE_PROTO"),un=function(){},sn=function(e){return"<script>"+e+"</"+"script>"},cn=function(e){e.write(sn("")),e.close();var n=e.parentWindow.Object;return e=null,n},ln=function(){try{nn=new ActiveXObject("htmlfile")}catch(e){}ln=document.domain&&nn?cn(nn):function(){var e,n=J("iframe");if(n.style)return n.style.display="none",on.appendChild(n),n.src=String("javascript:"),(e=n.contentWindow.document).open(),e.write(sn("document.F=Object")),e.close(),e.F}()||cn(nn);for(var e=Me.length;e--;)delete ln.prototype[Me[e]];return ln()};pe[an]=!0;var fn=Object.create||function(e,n){var t;return null!==e?(un.prototype=ee(e),t=new un,un.prototype=null,t[an]=e):t=ln(),void 0===n?t:rn(t,n)},hn=U("unscopables"),pn=Array.prototype;null==pn[hn]&&te.f(pn,hn,{configurable:!0,value:fn(null)});var dn;dn="flatMap",pn[hn][dn]=!0;var vn=Function.call,yn=function(e,n,t){return Je(vn,a[e].prototype[n],t)};yn("Array","flatMap");var gn,mn,bn,wn=!u((function(){function e(){}return e.prototype.constructor=null,Object.getPrototypeOf(new e)!==e.prototype})),_n=he("IE_PROTO"),xn=Object.prototype,kn=wn?Object.getPrototypeOf:function(e){return e=K(e),F(e,_n)?e[_n]:"function"==typeof e.constructor&&e instanceof e.constructor?e.constructor.prototype:e instanceof Object?xn:null},Sn=U("iterator"),On=!1;[].keys&&("next"in(bn=[].keys())?(mn=kn(kn(bn)))!==Object.prototype&&(gn=mn):On=!0),(null==gn||u((function(){var e={};return gn[Sn].call(e)!==e})))&&(gn={}),F(gn,Sn)||re(gn,Sn,(function(){return this}));var Cn={IteratorPrototype:gn,BUGGY_SAFARI_ITERATORS:On},En=te.f,An=U("toStringTag"),jn={},Pn=Cn.IteratorPrototype,In=function(){return this},Tn=function(e){if(P(e))throw TypeError("Cannot convert a Symbol value to a string");return String(e)},Mn=U("match"),Rn=function(e){var n;return b(e)&&(void 0!==(n=e[Mn])?!!n:"RegExp"==d(e))},Kn=function(){var e=ee(this),n="";return e.global&&(n+="g"),e.ignoreCase&&(n+="i"),e.multiline&&(n+="m"),e.dotAll&&(n+="s"),e.unicode&&(n+="u"),e.sticky&&(n+="y"),n},Dn=U("species"),Fn=function(e){return function(n,t){var r,i,o=Tn(g(n)),a=Oe(t),u=o.length;return a<0||a>=u?e?"":void 0:(r=o.charCodeAt(a))<55296||r>56319||a+1===u||(i=o.charCodeAt(a+1))<56320||i>57343?e?o.charAt(a):r:e?o.slice(a,a+2):i-56320+(r-55296<<10)+65536}},Nn={codeAt:Fn(!1),charAt:Fn(!0)}.charAt,zn=U("matchAll"),Ln="RegExp String",Bn="RegExp String Iterator",qn=_e.set,Hn=_e.getterFor(Bn),Un=RegExp.prototype,$n=Un.exec,Wn="".matchAll,Vn=!!Wn&&!u((function(){"a".matchAll(/./)})),Yn=function(e,n,t){var r,i,o,a=n+" Iterator";return e.prototype=fn(Pn,{next:h(1,t)}),i=a,o=!1,(r=e)&&!F(r=o?r:r.prototype,An)&&En(r,An,{configurable:!0,value:i}),jn[a]=In,e}((function(e,n,t,r){qn(this,{type:Bn,regexp:e,string:n,global:t,unicode:r,done:!1})}),Ln,(function(){var e=Hn(this);if(e.done)return{value:void 0,done:!0};var n=e.regexp,t=e.string,r=function(e,n){var t,r=e.exec;if("function"==typeof r){if("object"!=typeof(t=r.call(e,n)))throw TypeError("Incorrect exec result");return t}return $n.call(e,n)}(n,t);return null===r?{value:void 0,done:e.done=!0}:e.global?(""===Tn(r[0])&&(n.lastIndex=function(e,n,t){return n+(t?Nn(e,n).length:1)}(t,Ee(n.lastIndex),e.unicode)),{value:r,done:!1}):(e.done=!0,{value:r,done:!1})})),Gn=function(e){var n,t,r,i,o,a,u=ee(this),s=Tn(e);return n=function(e,n){var t,r=ee(e).constructor;return void 0===r||null==(t=ee(r)[Dn])?n:Ge(t)}(u,RegExp),void 0===(t=u.flags)&&u instanceof RegExp&&!("flags"in Un)&&(t=Kn.call(u)),r=void 0===t?"":Tn(t),i=new n(n===RegExp?u.source:u,r),o=!!~r.indexOf("g"),a=!!~r.indexOf("u"),i.lastIndex=Ee(u.lastIndex),new Yn(i,s,o,a)};Ve({target:"String",proto:!0,forced:Vn},{matchAll:function(e){var n,t,r=g(this);if(null!=e){if(Rn(e)&&!~Tn(g("flags"in Un?e.flags:Kn.call(e))).indexOf("g"))throw TypeError("`.matchAll` does not allow non-global regexes");if(Vn)return Wn.apply(r,arguments);if(null!=(t=e[zn]))return Ge(t).call(e,r)}else if(Vn)return Wn.apply(r,arguments);return n=Tn(r),new RegExp(e,"g")[zn](n)}}),zn in Un||re(Un,zn,Gn);var Jn={};Jn[U("toStringTag")]="z";var Qn="[object z]"===String(Jn),Xn=U("toStringTag"),Zn="Arguments"==d(function(){return arguments}()),et=Qn?d:function(e){var n,t,r;return void 0===e?"Undefined":null===e?"Null":"string"==typeof(t=function(e,n){try{return e[n]}catch(e){}}(n=Object(e),Xn))?t:Zn?d(n):"Object"==(r=d(n))&&"function"==typeof n.callee?"Arguments":r},nt=Qn?{}.toString:function(){return"[object "+et(this)+"]"};Qn||xe(Object.prototype,"toString",nt,{unsafe:!0});var tt,rt,it=function(e,n){return RegExp(e,n)},ot={UNSUPPORTED_Y:u((function(){var e=it("a","y");return e.lastIndex=2,null!=e.exec("abcd")})),BROKEN_CARET:u((function(){var e=it("^r","gy");return e.lastIndex=2,null!=e.exec("str")}))},at=u((function(){var e=RegExp(".","string".charAt(0));return!(e.dotAll&&e.exec("\n")&&"s"===e.flags)})),ut=u((function(){var e=RegExp("(?<a>b)","string".charAt(5));return"b"!==e.exec("b").groups.a||"bc"!=="b".replace(e,"$<a>c")})),st=_e.get,ct=RegExp.prototype.exec,lt=R("native-string-replace",String.prototype.replace),ft=ct,ht=(tt=/a/,rt=/b*/g,ct.call(tt,"a"),ct.call(rt,"a"),0!==tt.lastIndex||0!==rt.lastIndex),pt=ot.UNSUPPORTED_Y||ot.BROKEN_CARET,dt=void 0!==/()??/.exec("")[1];(ht||dt||pt||at||ut)&&(ft=function(e){var n,t,r,i,o,a,u,s=this,c=st(s),l=Tn(e),f=c.raw;if(f)return f.lastIndex=s.lastIndex,n=ft.call(f,l),s.lastIndex=f.lastIndex,n;var h=c.groups,p=pt&&s.sticky,d=Kn.call(s),v=s.source,y=0,g=l;if(p&&(-1===(d=d.replace("y","")).indexOf("g")&&(d+="g"),g=l.slice(s.lastIndex),s.lastIndex>0&&(!s.multiline||s.multiline&&"\n"!==l.charAt(s.lastIndex-1))&&(v="(?: "+v+")",g=" "+g,y++),t=new RegExp("^(?:"+v+")",d)),dt&&(t=new RegExp("^"+v+"$(?!\\s)",d)),ht&&(r=s.lastIndex),i=ct.call(p?t:s,g),p?i?(i.input=i.input.slice(y),i[0]=i[0].slice(y),i.index=s.lastIndex,s.lastIndex+=i[0].length):s.lastIndex=0:ht&&i&&(s.lastIndex=s.global?i.index+i[0].length:r),dt&&i&&i.length>1&&lt.call(i[0],t,(function(){for(o=1;o<arguments.length-2;o++)void 0===arguments[o]&&(i[o]=void 0)})),i&&h)for(i.groups=a=fn(null),o=0;o<h.length;o++)a[(u=h[o])[0]]=i[u[1]];return i});Ve({target:"RegExp",proto:!0,forced:/./.exec!==ft},{exec:ft}),yn("String","matchAll");var vt=function(){return(vt=Object.assign||function(e){for(var n,t=1,r=arguments.length;t<r;t++)for(var i in n=arguments[t])Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i]);return e}).apply(this,arguments)};function yt(){for(var e=0,n=0,t=arguments.length;n<t;n++)e+=arguments[n].length;var r=Array(e),i=0;for(n=0;n<t;n++)for(var o=arguments[n],a=0,u=o.length;a<u;a++,i++)r[i]=o[a];return r}var gt=Object.keys,mt=Array.isArray,bt="undefined"!=typeof self?self:"undefined"!=typeof window?window:global;function wt(e,n){return"object"!=typeof n||gt(n).forEach((function(t){e[t]=n[t]})),e}"undefined"==typeof Promise||bt.Promise||(bt.Promise=Promise);var _t=Object.getPrototypeOf,xt={}.hasOwnProperty;function kt(e,n){return xt.call(e,n)}function St(e,n){"function"==typeof n&&(n=n(_t(e))),gt(n).forEach((function(t){Ct(e,t,n[t])}))}var Ot=Object.defineProperty;function Ct(e,n,t,r){Ot(e,n,wt(t&&kt(t,"get")&&"function"==typeof t.get?{get:t.get,set:t.set,configurable:!0}:{value:t,configurable:!0,writable:!0},r))}function Et(e){return{from:function(n){return e.prototype=Object.create(n.prototype),Ct(e.prototype,"constructor",e),{extend:St.bind(null,e.prototype)}}}}var At=Object.getOwnPropertyDescriptor;function jt(e,n){var t;return At(e,n)||(t=_t(e))&&jt(t,n)}var Pt=[].slice;function It(e,n,t){return Pt.call(e,n,t)}function Tt(e,n){return n(e)}function Mt(e){if(!e)throw new Error("Assertion Failed")}function Rt(e){bt.setImmediate?setImmediate(e):setTimeout(e,0)}function Kt(e,n){return e.reduce((function(e,t,r){var i=n(t,r);return i&&(e[i[0]]=i[1]),e}),{})}function Dt(e,n){if(kt(e,n))return e[n];if(!n)return e;if("string"!=typeof n){for(var t=[],r=0,i=n.length;r<i;++r){var o=Dt(e,n[r]);t.push(o)}return t}var a=n.indexOf(".");if(-1!==a){var u=e[n.substr(0,a)];return void 0===u?void 0:Dt(u,n.substr(a+1))}}function Ft(e,n,t){if(e&&void 0!==n&&(!("isFrozen"in Object)||!Object.isFrozen(e)))if("string"!=typeof n&&"length"in n){Mt("string"!=typeof t&&"length"in t);for(var r=0,i=n.length;r<i;++r)Ft(e,n[r],t[r])}else{var o=n.indexOf(".");if(-1!==o){var a=n.substr(0,o),u=n.substr(o+1);if(""===u)void 0===t?mt(e)&&!isNaN(parseInt(a))?e.splice(a,1):delete e[a]:e[a]=t;else{var s=e[a];s||(s=e[a]={}),Ft(s,u,t)}}else void 0===t?mt(e)&&!isNaN(parseInt(n))?e.splice(n,1):delete e[n]:e[n]=t}}function Nt(e,n){"string"==typeof n?Ft(e,n,void 0):"length"in n&&[].map.call(n,(function(n){Ft(e,n,void 0)}))}function zt(e){var n={};for(var t in e)kt(e,t)&&(n[t]=e[t]);return n}var Lt=[].concat;function Bt(e){return Lt.apply([],e)}var qt="Boolean,String,Date,RegExp,Blob,File,FileList,ArrayBuffer,DataView,Uint8ClampedArray,ImageData,Map,Set".split(",").concat(Bt([8,16,32,64].map((function(e){return["Int","Uint","Float"].map((function(n){return n+e+"Array"}))})))).filter((function(e){return bt[e]})),Ht=qt.map((function(e){return bt[e]})),Ut=Kt(qt,(function(e){return[e,!0]}));function $t(e){if(!e||"object"!=typeof e)return e;var n;if(mt(e)){n=[];for(var t=0,r=e.length;t<r;++t)n.push($t(e[t]))}else if(Ht.indexOf(e.constructor)>=0)n=e;else for(var i in n=e.constructor?Object.create(e.constructor.prototype):{},e)kt(e,i)&&(n[i]=$t(e[i]));return n}var Wt={}.toString;function Vt(e){return Wt.call(e).slice(8,-1)}var Yt=function(e,n){return"Array"===n?""+e.map((function(e){return Yt(e,Vt(e))})):"ArrayBuffer"===n?""+new Uint8Array(e):"Date"===n?e.getTime():ArrayBuffer.isView(e)?""+new Uint8Array(e.buffer):e};function Gt(e,n,t,r){return t=t||{},r=r||"",gt(e).forEach((function(i){if(kt(n,i)){var o=e[i],a=n[i];if("object"==typeof o&&"object"==typeof a&&o&&a){var u=Vt(o),s=Vt(a);u===s?Ut[u]?Yt(o,u)!==Yt(a,s)&&(t[r+i]=n[i]):Gt(o,a,t,r+i+"."):t[r+i]=n[i]}else o!==a&&(t[r+i]=n[i])}else t[r+i]=void 0})),gt(n).forEach((function(i){kt(e,i)||(t[r+i]=n[i])})),t}var Jt="undefined"!=typeof Symbol&&Symbol.iterator,Qt=Jt?function(e){var n;return null!=e&&(n=e[Jt])&&n.apply(e)}:function(){return null},Xt={};function Zt(e){var n,t,r,i;if(1===arguments.length){if(mt(e))return e.slice();if(this===Xt&&"string"==typeof e)return[e];if(i=Qt(e)){for(t=[];!(r=i.next()).done;)t.push(r.value);return t}if(null==e)return[e];if("number"==typeof(n=e.length)){for(t=new Array(n);n--;)t[n]=e[n];return t}return[e]}for(n=arguments.length,t=new Array(n);n--;)t[n]=arguments[n];return t}var er="undefined"!=typeof Symbol?function(e){return"AsyncFunction"===e[Symbol.toStringTag]}:function(){return!1},nr="undefined"!=typeof location&&/^(http|https):\/\/(localhost|127\.0\.0\.1)/.test(location.href);function tr(e,n){nr=e,rr=n}var rr=function(){return!0},ir=!new Error("").stack;function or(){if(ir)try{throw new Error}catch(e){return e}return new Error}function ar(e,n){var t=e.stack;return t?(n=n||0,0===t.indexOf(e.name)&&(n+=(e.name+e.message).split("\n").length),t.split("\n").slice(n).filter(rr).map((function(e){return"\n"+e})).join("")):""}var ur=["Unknown","Constraint","Data","TransactionInactive","ReadOnly","Version","NotFound","InvalidState","InvalidAccess","Abort","Timeout","QuotaExceeded","Syntax","DataClone"],sr=["Modify","Bulk","OpenFailed","VersionChange","Schema","Upgrade","InvalidTable","MissingAPI","NoSuchDatabase","InvalidArgument","SubTransaction","Unsupported","Internal","DatabaseClosed","PrematureCommit","ForeignAwait"].concat(ur),cr={VersionChanged:"Database version changed by other database connection",DatabaseClosed:"Database has been closed",Abort:"Transaction aborted",TransactionInactive:"Transaction has already completed or failed"};function lr(e,n){this._e=or(),this.name=e,this.message=n}function fr(e,n){return e+". Errors: "+Object.keys(n).map((function(e){return n[e].toString()})).filter((function(e,n,t){return t.indexOf(e)===n})).join("\n")}function hr(e,n,t,r){this._e=or(),this.failures=n,this.failedKeys=r,this.successCount=t,this.message=fr(e,n)}function pr(e,n){this._e=or(),this.name="BulkError",this.failures=n,this.message=fr(e,n)}Et(lr).from(Error).extend({stack:{get:function(){return this._stack||(this._stack=this.name+": "+this.message+ar(this._e,2))}},toString:function(){return this.name+": "+this.message}}),Et(hr).from(lr),Et(pr).from(lr);var dr=sr.reduce((function(e,n){return e[n]=n+"Error",e}),{}),vr=lr,yr=sr.reduce((function(e,n){var t=n+"Error";function r(e,r){this._e=or(),this.name=t,e?"string"==typeof e?(this.message=e+(r?"\n "+r:""),this.inner=r||null):"object"==typeof e&&(this.message=e.name+" "+e.message,this.inner=e):(this.message=cr[n]||t,this.inner=null)}return Et(r).from(vr),e[n]=r,e}),{});yr.Syntax=SyntaxError,yr.Type=TypeError,yr.Range=RangeError;var gr=ur.reduce((function(e,n){return e[n+"Error"]=yr[n],e}),{});var mr=sr.reduce((function(e,n){return-1===["Syntax","Type","Range"].indexOf(n)&&(e[n+"Error"]=yr[n]),e}),{});function br(){}function wr(e){return e}function _r(e,n){return null==e||e===wr?n:function(t){return n(e(t))}}function xr(e,n){return function(){e.apply(this,arguments),n.apply(this,arguments)}}function kr(e,n){return e===br?n:function(){var t=e.apply(this,arguments);void 0!==t&&(arguments[0]=t);var r=this.onsuccess,i=this.onerror;this.onsuccess=null,this.onerror=null;var o=n.apply(this,arguments);return r&&(this.onsuccess=this.onsuccess?xr(r,this.onsuccess):r),i&&(this.onerror=this.onerror?xr(i,this.onerror):i),void 0!==o?o:t}}function Sr(e,n){return e===br?n:function(){e.apply(this,arguments);var t=this.onsuccess,r=this.onerror;this.onsuccess=this.onerror=null,n.apply(this,arguments),t&&(this.onsuccess=this.onsuccess?xr(t,this.onsuccess):t),r&&(this.onerror=this.onerror?xr(r,this.onerror):r)}}function Or(e,n){return e===br?n:function(t){var r=e.apply(this,arguments);wt(t,r);var i=this.onsuccess,o=this.onerror;this.onsuccess=null,this.onerror=null;var a=n.apply(this,arguments);return i&&(this.onsuccess=this.onsuccess?xr(i,this.onsuccess):i),o&&(this.onerror=this.onerror?xr(o,this.onerror):o),void 0===r?void 0===a?void 0:a:wt(r,a)}}function Cr(e,n){return e===br?n:function(){return!1!==n.apply(this,arguments)&&e.apply(this,arguments)}}function Er(e,n){return e===br?n:function(){var t=e.apply(this,arguments);if(t&&"function"==typeof t.then){for(var r=this,i=arguments.length,o=new Array(i);i--;)o[i]=arguments[i];return t.then((function(){return n.apply(r,o)}))}return n.apply(this,arguments)}}mr.ModifyError=hr,mr.DexieError=lr,mr.BulkError=pr;var Ar={},jr="undefined"==typeof Promise?[]:function(){var e=Promise.resolve();if("undefined"==typeof crypto||!crypto.subtle)return[e,e.__proto__,e];var n=crypto.subtle.digest("SHA-512",new Uint8Array([0]));return[n,n.__proto__,e]}(),Pr=jr[0],Ir=jr[1],Tr=jr[2],Mr=Ir&&Ir.then,Rr=Pr&&Pr.constructor,Kr=!!Tr,Dr=!1,Fr=Tr?function(){Tr.then(oi)}:bt.setImmediate?setImmediate.bind(null,oi):bt.MutationObserver?function(){var e=document.createElement("div");new MutationObserver((function(){oi(),e=null})).observe(e,{attributes:!0}),e.setAttribute("i","1")}:function(){setTimeout(oi,0)},Nr=function(e,n){Vr.push([e,n]),Lr&&(Fr(),Lr=!1)},zr=!0,Lr=!0,Br=[],qr=[],Hr=null,Ur=wr,$r={id:"global",global:!0,ref:0,unhandleds:[],onunhandled:Pi,pgp:!1,env:{},finalize:function(){this.unhandleds.forEach((function(e){try{Pi(e[0],e[1])}catch(e){}}))}},Wr=$r,Vr=[],Yr=0,Gr=[];function Jr(e){if("object"!=typeof this)throw new TypeError("Promises must be constructed via new");this._listeners=[],this.onuncatched=br,this._lib=!1;var n=this._PSD=Wr;if(nr&&(this._stackHolder=or(),this._prev=null,this._numPrev=0),"function"!=typeof e){if(e!==Ar)throw new TypeError("Not a function");return this._state=arguments[1],this._value=arguments[2],void(!1===this._state&&ei(this,this._value))}this._state=null,this._value=null,++n.ref,Zr(this,e)}var Qr={get:function(){var e=Wr,n=vi;function t(t,r){var i=this,o=!e.global&&(e!==Wr||n!==vi),a=o&&!bi(),u=new Jr((function(n,u){ti(i,new Xr(Ei(t,e,o,a),Ei(r,e,o,a),n,u,e))}));return nr&&ii(u,this),u}return t.prototype=Ar,t},set:function(e){Ct(this,"then",e&&e.prototype===Ar?Qr:{get:function(){return e},set:Qr.set})}};function Xr(e,n,t,r,i){this.onFulfilled="function"==typeof e?e:null,this.onRejected="function"==typeof n?n:null,this.resolve=t,this.reject=r,this.psd=i}function Zr(e,n){try{n((function(n){if(null===e._state){if(n===e)throw new TypeError("A promise cannot be resolved with itself.");var t=e._lib&&ai();n&&"function"==typeof n.then?Zr(e,(function(e,t){n instanceof Jr?n._then(e,t):n.then(e,t)})):(e._state=!0,e._value=n,ni(e)),t&&ui()}}),ei.bind(null,e))}catch(n){ei(e,n)}}function ei(e,n){if(qr.push(n),null===e._state){var t=e._lib&&ai();n=Ur(n),e._state=!1,e._value=n,nr&&null!==n&&"object"==typeof n&&!n._promise&&function(e,n,t){try{e.apply(null,t)}catch(e){n&&n(e)}}((function(){var t=jt(n,"stack");n._promise=e,Ct(n,"stack",{get:function(){return Dr?t&&(t.get?t.get.apply(n):t.value):e.stack}})})),function(e){Br.some((function(n){return n._value===e._value}))||Br.push(e)}(e),ni(e),t&&ui()}}function ni(e){var n=e._listeners;e._listeners=[];for(var t=0,r=n.length;t<r;++t)ti(e,n[t]);var i=e._PSD;--i.ref||i.finalize(),0===Yr&&(++Yr,Nr((function(){0==--Yr&&si()}),[]))}function ti(e,n){if(null!==e._state){var t=e._state?n.onFulfilled:n.onRejected;if(null===t)return(e._state?n.resolve:n.reject)(e._value);++n.psd.ref,++Yr,Nr(ri,[t,e,n])}else e._listeners.push(n)}function ri(e,n,t){try{Hr=n;var r,i=n._value;n._state?r=e(i):(qr.length&&(qr=[]),r=e(i),-1===qr.indexOf(i)&&function(e){var n=Br.length;for(;n;)if(Br[--n]._value===e._value)return void Br.splice(n,1)}(n)),t.resolve(r)}catch(e){t.reject(e)}finally{Hr=null,0==--Yr&&si(),--t.psd.ref||t.psd.finalize()}}function ii(e,n){var t=n?n._numPrev+1:0;t<100&&(e._prev=n,e._numPrev=t)}function oi(){ai()&&ui()}function ai(){var e=zr;return zr=!1,Lr=!1,e}function ui(){var e,n,t;do{for(;Vr.length>0;)for(e=Vr,Vr=[],t=e.length,n=0;n<t;++n){var r=e[n];r[0].apply(null,r[1])}}while(Vr.length>0);zr=!0,Lr=!0}function si(){var e=Br;Br=[],e.forEach((function(e){e._PSD.onunhandled.call(null,e._value,e)}));for(var n=Gr.slice(0),t=n.length;t;)n[--t]()}function ci(e){return new Jr(Ar,!1,e)}function li(e,n){var t=Wr;return function(){var r=ai(),i=Wr;try{return ki(t,!0),e.apply(this,arguments)}catch(e){n&&n(e)}finally{ki(i,!1),r&&ui()}}}St(Jr.prototype,{then:Qr,_then:function(e,n){ti(this,new Xr(null,null,e,n,Wr))},catch:function(e){if(1===arguments.length)return this.then(null,e);var n=arguments[0],t=arguments[1];return"function"==typeof n?this.then(null,(function(e){return e instanceof n?t(e):ci(e)})):this.then(null,(function(e){return e&&e.name===n?t(e):ci(e)}))},finally:function(e){return this.then((function(n){return e(),n}),(function(n){return e(),ci(n)}))},stack:{get:function(){if(this._stack)return this._stack;try{Dr=!0;var e=function e(n,t,r){if(t.length===r)return t;var i="";if(!1===n._state){var o,a,u=n._value;null!=u?(o=u.name||"Error",a=u.message||u,i=ar(u,0)):(o=u,a=""),t.push(o+(a?": "+a:"")+i)}nr&&((i=ar(n._stackHolder,2))&&-1===t.indexOf(i)&&t.push(i),n._prev&&e(n._prev,t,r));return t}(this,[],20).join("\nFrom previous: ");return null!==this._state&&(this._stack=e),e}finally{Dr=!1}}},timeout:function(e,n){var t=this;return e<1/0?new Jr((function(r,i){var o=setTimeout((function(){return i(new yr.Timeout(n))}),e);t.then(r,i).finally(clearTimeout.bind(null,o))})):this}}),"undefined"!=typeof Symbol&&Symbol.toStringTag&&Ct(Jr.prototype,Symbol.toStringTag,"Dexie.Promise"),$r.env=Si(),St(Jr,{all:function(){var e=Zt.apply(null,arguments).map(wi);return new Jr((function(n,t){0===e.length&&n([]);var r=e.length;e.forEach((function(i,o){return Jr.resolve(i).then((function(t){e[o]=t,--r||n(e)}),t)}))}))},resolve:function(e){if(e instanceof Jr)return e;if(e&&"function"==typeof e.then)return new Jr((function(n,t){e.then(n,t)}));var n=new Jr(Ar,!0,e);return ii(n,Hr),n},reject:ci,race:function(){var e=Zt.apply(null,arguments).map(wi);return new Jr((function(n,t){e.map((function(e){return Jr.resolve(e).then(n,t)}))}))},PSD:{get:function(){return Wr},set:function(e){return Wr=e}},totalEchoes:{get:function(){return vi}},newPSD:gi,usePSD:Oi,scheduler:{get:function(){return Nr},set:function(e){Nr=e}},rejectionMapper:{get:function(){return Ur},set:function(e){Ur=e}},follow:function(e,n){return new Jr((function(t,r){return gi((function(n,t){var r=Wr;r.unhandleds=[],r.onunhandled=t,r.finalize=xr((function(){var e=this;!function(e){function n(){e(),Gr.splice(Gr.indexOf(n),1)}Gr.push(n),++Yr,Nr((function(){0==--Yr&&si()}),[])}((function(){0===e.unhandleds.length?n():t(e.unhandleds[0])}))}),r.finalize),e()}),n,t,r)}))}}),Rr&&(Rr.allSettled&&Ct(Jr,"allSettled",(function(){var e=Zt.apply(null,arguments).map(wi);return new Jr((function(n){0===e.length&&n([]);var t=e.length,r=new Array(t);e.forEach((function(e,i){return Jr.resolve(e).then((function(e){return r[i]={status:"fulfilled",value:e}}),(function(e){return r[i]={status:"rejected",reason:e}})).then((function(){return--t||n(r)}))}))}))})),Rr.any&&"undefined"!=typeof AggregateError&&Ct(Jr,"any",(function(){var e=Zt.apply(null,arguments).map(wi);return new Jr((function(n,t){0===e.length&&t(new AggregateError([]));var r=e.length,i=new Array(r);e.forEach((function(e,o){return Jr.resolve(e).then((function(e){return n(e)}),(function(e){i[o]=e,--r||t(new AggregateError(i))}))}))}))})));var fi={awaits:0,echoes:0,id:0},hi=0,pi=[],di=0,vi=0,yi=0;function gi(e,n,t,r){var i=Wr,o=Object.create(i);o.parent=i,o.ref=0,o.global=!1,o.id=++yi;var a=$r.env;o.env=Kr?{Promise:Jr,PromiseProp:{value:Jr,configurable:!0,writable:!0},all:Jr.all,race:Jr.race,allSettled:Jr.allSettled,any:Jr.any,resolve:Jr.resolve,reject:Jr.reject,nthen:Ai(a.nthen,o),gthen:Ai(a.gthen,o)}:{},n&&wt(o,n),++i.ref,o.finalize=function(){--this.parent.ref||this.parent.finalize()};var u=Oi(o,e,t,r);return 0===o.ref&&o.finalize(),u}function mi(){return fi.id||(fi.id=++hi),++fi.awaits,fi.echoes+=100,fi.id}function bi(){return!!fi.awaits&&(0==--fi.awaits&&(fi.id=0),fi.echoes=100*fi.awaits,!0)}function wi(e){return fi.echoes&&e&&e.constructor===Rr?(mi(),e.then((function(e){return bi(),e}),(function(e){return bi(),Ii(e)}))):e}function _i(e){++vi,fi.echoes&&0!=--fi.echoes||(fi.echoes=fi.id=0),pi.push(Wr),ki(e,!0)}function xi(){var e=pi[pi.length-1];pi.pop(),ki(e,!1)}function ki(e,n){var t=Wr;if((n?!fi.echoes||di++&&e===Wr:!di||--di&&e===Wr)||Ci(n?_i.bind(null,e):xi),e!==Wr&&(Wr=e,t===$r&&($r.env=Si()),Kr)){var r=$r.env.Promise,i=e.env;Ir.then=i.nthen,r.prototype.then=i.gthen,(t.global||e.global)&&(Object.defineProperty(bt,"Promise",i.PromiseProp),r.all=i.all,r.race=i.race,r.resolve=i.resolve,r.reject=i.reject,i.allSettled&&(r.allSettled=i.allSettled),i.any&&(r.any=i.any))}}function Si(){var e=bt.Promise;return Kr?{Promise:e,PromiseProp:Object.getOwnPropertyDescriptor(bt,"Promise"),all:e.all,race:e.race,allSettled:e.allSettled,any:e.any,resolve:e.resolve,reject:e.reject,nthen:Ir.then,gthen:e.prototype.then}:{}}function Oi(e,n,t,r,i){var o=Wr;try{return ki(e,!0),n(t,r,i)}finally{ki(o,!1)}}function Ci(e){Mr.call(Pr,e)}function Ei(e,n,t,r){return"function"!=typeof e?e:function(){var i=Wr;t&&mi(),ki(n,!0);try{return e.apply(this,arguments)}finally{ki(i,!1),r&&Ci(bi)}}}function Ai(e,n){return function(t,r){return e.call(this,Ei(t,n),Ei(r,n))}}-1===(""+Mr).indexOf("[native code]")&&(mi=bi=br);var ji="unhandledrejection";function Pi(e,n){var t;try{t=n.onuncatched(e)}catch(e){}if(!1!==t)try{var r,i={promise:n,reason:e};if(bt.document&&document.createEvent?((r=document.createEvent("Event")).initEvent(ji,!0,!0),wt(r,i)):bt.CustomEvent&&wt(r=new CustomEvent(ji,{detail:i}),i),r&&bt.dispatchEvent&&(dispatchEvent(r),!bt.PromiseRejectionEvent&&bt.onunhandledrejection))try{bt.onunhandledrejection(r)}catch(e){}nr&&r&&!r.defaultPrevented&&console.warn("Unhandled rejection: "+(e.stack||e))}catch(e){}}var Ii=Jr.reject;var Ti="3.0.3",Mi=String.fromCharCode(65535),Ri=-1/0,Ki="Invalid key provided. Keys must be of type string, number, Date or Array<string | number | Date>.",Di="String expected.",Fi=[],Ni="undefined"!=typeof navigator&&/(MSIE|Trident|Edge)/.test(navigator.userAgent),zi=Ni,Li=Ni,Bi=function(e){return!/(dexie\.js|dexie\.min\.js)/.test(e)},qi="__dbnames",Hi="readonly",Ui="readwrite";function $i(e,n){return e?n?function(){return e.apply(this,arguments)&&n.apply(this,arguments)}:e:n}var Wi={type:3,lower:-1/0,lowerOpen:!1,upper:[[]],upperOpen:!1};function Vi(e){return function(n){return void 0===Dt(n,e)&&Nt(n=$t(n),e),n}}var Yi=function(){function e(){}return e.prototype._trans=function(e,n,t){var r=this._tx||Wr.trans,i=this.name;function o(e,t,r){if(!r.schema[i])throw new yr.NotFound("Table "+i+" not part of transaction");return n(r.idbtrans,r)}var a=ai();try{return r&&r.db===this.db?r===Wr.trans?r._promise(e,o,t):gi((function(){return r._promise(e,o,t)}),{trans:r,transless:Wr.transless||Wr}):function e(n,t,r,i){if(n._state.openComplete||Wr.letThrough){var o=n._createTransaction(t,r,n._dbSchema);try{o.create()}catch(e){return Ii(e)}return o._promise(t,(function(e,n){return gi((function(){return Wr.trans=o,i(e,n,o)}))})).then((function(e){return o._completion.then((function(){return e}))}))}if(!n._state.isBeingOpened){if(!n._options.autoOpen)return Ii(new yr.DatabaseClosed);n.open().catch(br)}return n._state.dbReadyPromise.then((function(){return e(n,t,r,i)}))}(this.db,e,[this.name],o)}finally{a&&ui()}},e.prototype.get=function(e,n){var t=this;return e&&e.constructor===Object?this.where(e).first(n):this._trans("readonly",(function(n){return t.core.get({trans:n,key:e}).then((function(e){return t.hook.reading.fire(e)}))})).then(n)},e.prototype.where=function(e){if("string"==typeof e)return new this.db.WhereClause(this,e);if(mt(e))return new this.db.WhereClause(this,"["+e.join("+")+"]");var n=gt(e);if(1===n.length)return this.where(n[0]).equals(e[n[0]]);var t=this.schema.indexes.concat(this.schema.primKey).filter((function(e){return e.compound&&n.every((function(n){return e.keyPath.indexOf(n)>=0}))&&e.keyPath.every((function(e){return n.indexOf(e)>=0}))}))[0];if(t&&this.db._maxKey!==Mi)return this.where(t.name).equals(t.keyPath.map((function(n){return e[n]})));!t&&nr&&console.warn("The query "+JSON.stringify(e)+" on "+this.name+" would benefit of a compound index ["+n.join("+")+"]");var r=this.schema.idxByName,i=this.db._deps.indexedDB;function o(e,n){try{return 0===i.cmp(e,n)}catch(e){return!1}}var a=n.reduce((function(n,t){var i=n[0],a=n[1],u=r[t],s=e[t];return[i||u,i||!u?$i(a,u&&u.multi?function(e){var n=Dt(e,t);return mt(n)&&n.some((function(e){return o(s,e)}))}:function(e){return o(s,Dt(e,t))}):a]}),[null,null]),u=a[0],s=a[1];return u?this.where(u.name).equals(e[u.keyPath]).filter(s):t?this.filter(s):this.where(n).equals("")},e.prototype.filter=function(e){return this.toCollection().and(e)},e.prototype.count=function(e){return this.toCollection().count(e)},e.prototype.offset=function(e){return this.toCollection().offset(e)},e.prototype.limit=function(e){return this.toCollection().limit(e)},e.prototype.each=function(e){return this.toCollection().each(e)},e.prototype.toArray=function(e){return this.toCollection().toArray(e)},e.prototype.toCollection=function(){return new this.db.Collection(new this.db.WhereClause(this))},e.prototype.orderBy=function(e){return new this.db.Collection(new this.db.WhereClause(this,mt(e)?"["+e.join("+")+"]":e))},e.prototype.reverse=function(){return this.toCollection().reverse()},e.prototype.mapToClass=function(e){this.schema.mappedClass=e;var n=function(n){if(!n)return n;var t=Object.create(e.prototype);for(var r in n)if(kt(n,r))try{t[r]=n[r]}catch(e){}return t};return this.schema.readHook&&this.hook.reading.unsubscribe(this.schema.readHook),this.schema.readHook=n,this.hook("reading",n),e},e.prototype.defineClass=function(){return this.mapToClass((function(e){wt(this,e)}))},e.prototype.add=function(e,n){var t=this,r=this.schema.primKey,i=r.auto,o=r.keyPath,a=e;return o&&i&&(a=Vi(o)(e)),this._trans("readwrite",(function(e){return t.core.mutate({trans:e,type:"add",keys:null!=n?[n]:null,values:[a]})})).then((function(e){return e.numFailures?Jr.reject(e.failures[0]):e.lastResult})).then((function(n){if(o)try{Ft(e,o,n)}catch(e){}return n}))},e.prototype.update=function(e,n){if("object"!=typeof n||mt(n))throw new yr.InvalidArgument("Modifications must be an object.");if("object"!=typeof e||mt(e))return this.where(":id").equals(e).modify(n);gt(n).forEach((function(t){Ft(e,t,n[t])}));var t=Dt(e,this.schema.primKey.keyPath);return void 0===t?Ii(new yr.InvalidArgument("Given object does not contain its primary key")):this.where(":id").equals(t).modify(n)},e.prototype.put=function(e,n){var t=this,r=this.schema.primKey,i=r.auto,o=r.keyPath,a=e;return o&&i&&(a=Vi(o)(e)),this._trans("readwrite",(function(e){return t.core.mutate({trans:e,type:"put",values:[a],keys:null!=n?[n]:null})})).then((function(e){return e.numFailures?Jr.reject(e.failures[0]):e.lastResult})).then((function(n){if(o)try{Ft(e,o,n)}catch(e){}return n}))},e.prototype.delete=function(e){var n=this;return this._trans("readwrite",(function(t){return n.core.mutate({trans:t,type:"delete",keys:[e]})})).then((function(e){return e.numFailures?Jr.reject(e.failures[0]):void 0}))},e.prototype.clear=function(){var e=this;return this._trans("readwrite",(function(n){return e.core.mutate({trans:n,type:"deleteRange",range:Wi})})).then((function(e){return e.numFailures?Jr.reject(e.failures[0]):void 0}))},e.prototype.bulkGet=function(e){var n=this;return this._trans("readonly",(function(t){return n.core.getMany({keys:e,trans:t}).then((function(e){return e.map((function(e){return n.hook.reading.fire(e)}))}))}))},e.prototype.bulkAdd=function(e,n,t){var r=this,i=Array.isArray(n)?n:void 0,o=(t=t||(i?void 0:n))?t.allKeys:void 0;return this._trans("readwrite",(function(n){var t=r.schema.primKey,a=t.auto,u=t.keyPath;if(u&&i)throw new yr.InvalidArgument("bulkAdd(): keys argument invalid on tables with inbound keys");if(i&&i.length!==e.length)throw new yr.InvalidArgument("Arguments objects and keys must have the same length");var s=e.length,c=u&&a?e.map(Vi(u)):e;return r.core.mutate({trans:n,type:"add",keys:i,values:c,wantResults:o}).then((function(e){var n=e.numFailures,t=e.results,i=e.lastResult,a=e.failures;if(0===n)return o?t:i;throw new pr(r.name+".bulkAdd(): "+n+" of "+s+" operations failed",Object.keys(a).map((function(e){return a[e]})))}))}))},e.prototype.bulkPut=function(e,n,t){var r=this,i=Array.isArray(n)?n:void 0,o=(t=t||(i?void 0:n))?t.allKeys:void 0;return this._trans("readwrite",(function(n){var t=r.schema.primKey,a=t.auto,u=t.keyPath;if(u&&i)throw new yr.InvalidArgument("bulkPut(): keys argument invalid on tables with inbound keys");if(i&&i.length!==e.length)throw new yr.InvalidArgument("Arguments objects and keys must have the same length");var s=e.length,c=u&&a?e.map(Vi(u)):e;return r.core.mutate({trans:n,type:"put",keys:i,values:c,wantResults:o}).then((function(e){var n=e.numFailures,t=e.results,i=e.lastResult,a=e.failures;if(0===n)return o?t:i;throw new pr(r.name+".bulkPut(): "+n+" of "+s+" operations failed",Object.keys(a).map((function(e){return a[e]})))}))}))},e.prototype.bulkDelete=function(e){var n=this,t=e.length;return this._trans("readwrite",(function(t){return n.core.mutate({trans:t,type:"delete",keys:e})})).then((function(e){var r=e.numFailures,i=e.lastResult,o=e.failures;if(0===r)return i;throw new pr(n.name+".bulkDelete(): "+r+" of "+t+" operations failed",o)}))},e}();function Gi(e){var n={},t=function(t,r){if(r){for(var i=arguments.length,o=new Array(i-1);--i;)o[i-1]=arguments[i];return n[t].subscribe.apply(null,o),e}if("string"==typeof t)return n[t]};t.addEventType=o;for(var r=1,i=arguments.length;r<i;++r)o(arguments[r]);return t;function o(e,r,i){if("object"==typeof e)return a(e);r||(r=Cr),i||(i=br);var o={subscribers:[],fire:i,subscribe:function(e){-1===o.subscribers.indexOf(e)&&(o.subscribers.push(e),o.fire=r(o.fire,e))},unsubscribe:function(e){o.subscribers=o.subscribers.filter((function(n){return n!==e})),o.fire=o.subscribers.reduce(r,i)}};return n[e]=t[e]=o,o}function a(e){gt(e).forEach((function(n){var t=e[n];if(mt(t))o(n,e[n][0],e[n][1]);else{if("asap"!==t)throw new yr.InvalidArgument("Invalid event config");var r=o(n,wr,(function(){for(var e=arguments.length,n=new Array(e);e--;)n[e]=arguments[e];r.subscribers.forEach((function(e){Rt((function(){e.apply(null,n)}))}))}))}}))}}function Ji(e,n){return Et(n).from({prototype:e}),n}function Qi(e,n){return!(e.filter||e.algorithm||e.or)&&(n?e.justLimit:!e.replayFilter)}function Xi(e,n){e.filter=$i(e.filter,n)}function Zi(e,n,t){var r=e.replayFilter;e.replayFilter=r?function(){return $i(r(),n())}:n,e.justLimit=t&&!r}function eo(e,n){if(e.isPrimKey)return n.primaryKey;var t=n.getIndexByKeyPath(e.index);if(!t)throw new yr.Schema("KeyPath "+e.index+" on object store "+n.name+" is not indexed");return t}function no(e,n,t){var r=eo(e,n.schema);return n.openCursor({trans:t,values:!e.keysOnly,reverse:"prev"===e.dir,unique:!!e.unique,query:{index:r,range:e.range}})}function to(e,n,t,r){var i=e.replayFilter?$i(e.filter,e.replayFilter()):e.filter;if(e.or){var o={},a=function(e,t,r){if(!i||i(t,r,(function(e){return t.stop(e)}),(function(e){return t.fail(e)}))){var a=t.primaryKey,u=""+a;"[object ArrayBuffer]"===u&&(u=""+new Uint8Array(a)),kt(o,u)||(o[u]=!0,n(e,t,r))}};return Promise.all([e.or._iterate(a,t),ro(no(e,r,t),e.algorithm,a,!e.keysOnly&&e.valueMapper)])}return ro(no(e,r,t),$i(e.algorithm,i),n,!e.keysOnly&&e.valueMapper)}function ro(e,n,t,r){var i=li(r?function(e,n,i){return t(r(e),n,i)}:t);return e.then((function(e){if(e)return e.start((function(){var t=function(){return e.continue()};n&&!n(e,(function(e){return t=e}),(function(n){e.stop(n),t=br}),(function(n){e.fail(n),t=br}))||i(e.value,e,(function(e){return t=e})),t()}))}))}var io=function(){function e(){}return e.prototype._read=function(e,n){var t=this._ctx;return t.error?t.table._trans(null,Ii.bind(null,t.error)):t.table._trans("readonly",e).then(n)},e.prototype._write=function(e){var n=this._ctx;return n.error?n.table._trans(null,Ii.bind(null,n.error)):n.table._trans("readwrite",e,"locked")},e.prototype._addAlgorithm=function(e){var n=this._ctx;n.algorithm=$i(n.algorithm,e)},e.prototype._iterate=function(e,n){return to(this._ctx,e,n,this._ctx.table.core)},e.prototype.clone=function(e){var n=Object.create(this.constructor.prototype),t=Object.create(this._ctx);return e&&wt(t,e),n._ctx=t,n},e.prototype.raw=function(){return this._ctx.valueMapper=null,this},e.prototype.each=function(e){var n=this._ctx;return this._read((function(t){return to(n,e,t,n.table.core)}))},e.prototype.count=function(e){var n=this;return this._read((function(e){var t=n._ctx,r=t.table.core;if(Qi(t,!0))return r.count({trans:e,query:{index:eo(t,r.schema),range:t.range}}).then((function(e){return Math.min(e,t.limit)}));var i=0;return to(t,(function(){return++i,!1}),e,r).then((function(){return i}))})).then(e)},e.prototype.sortBy=function(e,n){var t=e.split(".").reverse(),r=t[0],i=t.length-1;function o(e,n){return n?o(e[t[n]],n-1):e[r]}var a="next"===this._ctx.dir?1:-1;function u(e,n){var t=o(e,i),r=o(n,i);return t<r?-a:t>r?a:0}return this.toArray((function(e){return e.sort(u)})).then(n)},e.prototype.toArray=function(e){var n=this;return this._read((function(e){var t=n._ctx;if("next"===t.dir&&Qi(t,!0)&&t.limit>0){var r=t.valueMapper,i=eo(t,t.table.core.schema);return t.table.core.query({trans:e,limit:t.limit,values:!0,query:{index:i,range:t.range}}).then((function(e){var n=e.result;return r?n.map(r):n}))}var o=[];return to(t,(function(e){return o.push(e)}),e,t.table.core).then((function(){return o}))}),e)},e.prototype.offset=function(e){var n=this._ctx;return e<=0||(n.offset+=e,Qi(n)?Zi(n,(function(){var n=e;return function(e,t){return 0===n||(1===n?(--n,!1):(t((function(){e.advance(n),n=0})),!1))}})):Zi(n,(function(){var n=e;return function(){return--n<0}}))),this},e.prototype.limit=function(e){return this._ctx.limit=Math.min(this._ctx.limit,e),Zi(this._ctx,(function(){var n=e;return function(e,t,r){return--n<=0&&t(r),n>=0}}),!0),this},e.prototype.until=function(e,n){return Xi(this._ctx,(function(t,r,i){return!e(t.value)||(r(i),n)})),this},e.prototype.first=function(e){return this.limit(1).toArray((function(e){return e[0]})).then(e)},e.prototype.last=function(e){return this.reverse().first(e)},e.prototype.filter=function(e){var n,t;return Xi(this._ctx,(function(n){return e(n.value)})),n=this._ctx,t=e,n.isMatch=$i(n.isMatch,t),this},e.prototype.and=function(e){return this.filter(e)},e.prototype.or=function(e){return new this.db.WhereClause(this._ctx.table,e,this)},e.prototype.reverse=function(){return this._ctx.dir="prev"===this._ctx.dir?"next":"prev",this._ondirectionchange&&this._ondirectionchange(this._ctx.dir),this},e.prototype.desc=function(){return this.reverse()},e.prototype.eachKey=function(e){var n=this._ctx;return n.keysOnly=!n.isMatch,this.each((function(n,t){e(t.key,t)}))},e.prototype.eachUniqueKey=function(e){return this._ctx.unique="unique",this.eachKey(e)},e.prototype.eachPrimaryKey=function(e){var n=this._ctx;return n.keysOnly=!n.isMatch,this.each((function(n,t){e(t.primaryKey,t)}))},e.prototype.keys=function(e){var n=this._ctx;n.keysOnly=!n.isMatch;var t=[];return this.each((function(e,n){t.push(n.key)})).then((function(){return t})).then(e)},e.prototype.primaryKeys=function(e){var n=this._ctx;if("next"===n.dir&&Qi(n,!0)&&n.limit>0)return this._read((function(e){var t=eo(n,n.table.core.schema);return n.table.core.query({trans:e,values:!1,limit:n.limit,query:{index:t,range:n.range}})})).then((function(e){return e.result})).then(e);n.keysOnly=!n.isMatch;var t=[];return this.each((function(e,n){t.push(n.primaryKey)})).then((function(){return t})).then(e)},e.prototype.uniqueKeys=function(e){return this._ctx.unique="unique",this.keys(e)},e.prototype.firstKey=function(e){return this.limit(1).keys((function(e){return e[0]})).then(e)},e.prototype.lastKey=function(e){return this.reverse().firstKey(e)},e.prototype.distinct=function(){var e=this._ctx,n=e.index&&e.table.schema.idxByName[e.index];if(!n||!n.multi)return this;var t={};return Xi(this._ctx,(function(e){var n=e.primaryKey.toString(),r=kt(t,n);return t[n]=!0,!r})),this},e.prototype.modify=function(e){var n=this,t=this._ctx;return this._write((function(r){var i;if("function"==typeof e)i=e;else{var o=gt(e),a=o.length;i=function(n){for(var t=!1,r=0;r<a;++r){var i=o[r],u=e[i];Dt(n,i)!==u&&(Ft(n,i,u),t=!0)}return t}}var u=t.table.core,s=u.schema.primaryKey,c=s.outbound,l=s.extractKey,f="testmode"in Jo?1:2e3,h=n.db.core.cmp,p=[],d=0,v=[],y=function(e,n){var t=n.failures,r=n.numFailures;d+=e-r;for(var i=0,o=gt(t);i<o.length;i++){var a=o[i];p.push(t[a])}};return n.clone().primaryKeys().then((function(e){var n=function(t){var o=Math.min(f,e.length-t);return u.getMany({trans:r,keys:e.slice(t,t+o)}).then((function(a){for(var s=[],p=[],d=c?[]:null,v=[],g=0;g<o;++g){var m=a[g],b={value:$t(m),primKey:e[t+g]};!1!==i.call(b,b.value,b)&&(null==b.value?v.push(e[t+g]):c||0===h(l(m),l(b.value))?(p.push(b.value),c&&d.push(e[t+g])):(v.push(e[t+g]),s.push(b.value)))}return Promise.resolve(s.length>0&&u.mutate({trans:r,type:"add",values:s}).then((function(e){for(var n in e.failures)v.splice(parseInt(n),1);y(s.length,e)}))).then((function(e){return p.length>0&&u.mutate({trans:r,type:"put",keys:d,values:p}).then((function(e){return y(p.length,e)}))})).then((function(){return v.length>0&&u.mutate({trans:r,type:"delete",keys:v}).then((function(e){return y(v.length,e)}))})).then((function(){return e.length>t+o&&n(t+f)}))}))};return n(0).then((function(){if(p.length>0)throw new hr("Error modifying one or more objects",p,d,v);return e.length}))}))}))},e.prototype.delete=function(){var e=this._ctx,n=e.range;return Qi(e)&&(e.isPrimKey&&!Li||3===n.type)?this._write((function(t){var r=e.table.core.schema.primaryKey,i=n;return e.table.core.count({trans:t,query:{index:r,range:i}}).then((function(n){return e.table.core.mutate({trans:t,type:"deleteRange",range:i}).then((function(e){var t=e.failures;e.lastResult,e.results;var r=e.numFailures;if(r)throw new hr("Could not delete some values",Object.keys(t).map((function(e){return t[e]})),n-r);return n-r}))}))})):this.modify((function(e,n){return n.value=null}))},e}();function oo(e,n){return e<n?-1:e===n?0:1}function ao(e,n){return e>n?-1:e===n?0:1}function uo(e,n,t){var r=e instanceof po?new e.Collection(e):e;return r._ctx.error=t?new t(n):new TypeError(n),r}function so(e){return new e.Collection(e,(function(){return ho("")})).limit(0)}function co(e,n,t,r,i,o){for(var a=Math.min(e.length,r.length),u=-1,s=0;s<a;++s){var c=n[s];if(c!==r[s])return i(e[s],t[s])<0?e.substr(0,s)+t[s]+t.substr(s+1):i(e[s],r[s])<0?e.substr(0,s)+r[s]+t.substr(s+1):u>=0?e.substr(0,u)+n[u]+t.substr(u+1):null;i(e[s],c)<0&&(u=s)}return a<r.length&&"next"===o?e+t.substr(e.length):a<e.length&&"prev"===o?e.substr(0,t.length):u<0?null:e.substr(0,u)+r[u]+t.substr(u+1)}function lo(e,n,t,r){var i,o,a,u,s,c,l,f=t.length;if(!t.every((function(e){return"string"==typeof e})))return uo(e,Di);function h(e){i=function(e){return"next"===e?function(e){return e.toUpperCase()}:function(e){return e.toLowerCase()}}(e),o=function(e){return"next"===e?function(e){return e.toLowerCase()}:function(e){return e.toUpperCase()}}(e),a="next"===e?oo:ao;var n=t.map((function(e){return{lower:o(e),upper:i(e)}})).sort((function(e,n){return a(e.lower,n.lower)}));u=n.map((function(e){return e.upper})),s=n.map((function(e){return e.lower})),c=e,l="next"===e?"":r}h("next");var p=new e.Collection(e,(function(){return fo(u[0],s[f-1]+r)}));p._ondirectionchange=function(e){h(e)};var d=0;return p._addAlgorithm((function(e,t,r){var i=e.key;if("string"!=typeof i)return!1;var h=o(i);if(n(h,s,d))return!0;for(var p=null,v=d;v<f;++v){var y=co(i,h,u[v],s[v],a,c);null===y&&null===p?d=v+1:(null===p||a(p,y)>0)&&(p=y)}return t(null!==p?function(){e.continue(p+l)}:r),!1})),p}function fo(e,n,t,r){return{type:2,lower:e,upper:n,lowerOpen:t,upperOpen:r}}function ho(e){return{type:1,lower:e,upper:e}}var po=function(){function e(){}return Object.defineProperty(e.prototype,"Collection",{get:function(){return this._ctx.table.db.Collection},enumerable:!0,configurable:!0}),e.prototype.between=function(e,n,t,r){t=!1!==t,r=!0===r;try{return this._cmp(e,n)>0||0===this._cmp(e,n)&&(t||r)&&(!t||!r)?so(this):new this.Collection(this,(function(){return fo(e,n,!t,!r)}))}catch(e){return uo(this,Ki)}},e.prototype.equals=function(e){return null==e?uo(this,Ki):new this.Collection(this,(function(){return ho(e)}))},e.prototype.above=function(e){return null==e?uo(this,Ki):new this.Collection(this,(function(){return fo(e,void 0,!0)}))},e.prototype.aboveOrEqual=function(e){return null==e?uo(this,Ki):new this.Collection(this,(function(){return fo(e,void 0,!1)}))},e.prototype.below=function(e){return null==e?uo(this,Ki):new this.Collection(this,(function(){return fo(void 0,e,!1,!0)}))},e.prototype.belowOrEqual=function(e){return null==e?uo(this,Ki):new this.Collection(this,(function(){return fo(void 0,e)}))},e.prototype.startsWith=function(e){return"string"!=typeof e?uo(this,Di):this.between(e,e+Mi,!0,!0)},e.prototype.startsWithIgnoreCase=function(e){return""===e?this.startsWith(e):lo(this,(function(e,n){return 0===e.indexOf(n[0])}),[e],Mi)},e.prototype.equalsIgnoreCase=function(e){return lo(this,(function(e,n){return e===n[0]}),[e],"")},e.prototype.anyOfIgnoreCase=function(){var e=Zt.apply(Xt,arguments);return 0===e.length?so(this):lo(this,(function(e,n){return-1!==n.indexOf(e)}),e,"")},e.prototype.startsWithAnyOfIgnoreCase=function(){var e=Zt.apply(Xt,arguments);return 0===e.length?so(this):lo(this,(function(e,n){return n.some((function(n){return 0===e.indexOf(n)}))}),e,Mi)},e.prototype.anyOf=function(){var e=this,n=Zt.apply(Xt,arguments),t=this._cmp;try{n.sort(t)}catch(e){return uo(this,Ki)}if(0===n.length)return so(this);var r=new this.Collection(this,(function(){return fo(n[0],n[n.length-1])}));r._ondirectionchange=function(r){t="next"===r?e._ascending:e._descending,n.sort(t)};var i=0;return r._addAlgorithm((function(e,r,o){for(var a=e.key;t(a,n[i])>0;)if(++i===n.length)return r(o),!1;return 0===t(a,n[i])||(r((function(){e.continue(n[i])})),!1)})),r},e.prototype.notEqual=function(e){return this.inAnyRange([[Ri,e],[e,this.db._maxKey]],{includeLowers:!1,includeUppers:!1})},e.prototype.noneOf=function(){var e=Zt.apply(Xt,arguments);if(0===e.length)return new this.Collection(this);try{e.sort(this._ascending)}catch(e){return uo(this,Ki)}var n=e.reduce((function(e,n){return e?e.concat([[e[e.length-1][1],n]]):[[Ri,n]]}),null);return n.push([e[e.length-1],this.db._maxKey]),this.inAnyRange(n,{includeLowers:!1,includeUppers:!1})},e.prototype.inAnyRange=function(e,n){var t=this,r=this._cmp,i=this._ascending,o=this._descending,a=this._min,u=this._max;if(0===e.length)return so(this);if(!e.every((function(e){return void 0!==e[0]&&void 0!==e[1]&&i(e[0],e[1])<=0})))return uo(this,"First argument to inAnyRange() must be an Array of two-value Arrays [lower,upper] where upper must not be lower than lower",yr.InvalidArgument);var s=!n||!1!==n.includeLowers,c=n&&!0===n.includeUppers;var l,f=i;function h(e,n){return f(e[0],n[0])}try{(l=e.reduce((function(e,n){for(var t=0,i=e.length;t<i;++t){var o=e[t];if(r(n[0],o[1])<0&&r(n[1],o[0])>0){o[0]=a(o[0],n[0]),o[1]=u(o[1],n[1]);break}}return t===i&&e.push(n),e}),[])).sort(h)}catch(e){return uo(this,Ki)}var p=0,d=c?function(e){return i(e,l[p][1])>0}:function(e){return i(e,l[p][1])>=0},v=s?function(e){return o(e,l[p][0])>0}:function(e){return o(e,l[p][0])>=0};var y=d,g=new this.Collection(this,(function(){return fo(l[0][0],l[l.length-1][1],!s,!c)}));return g._ondirectionchange=function(e){"next"===e?(y=d,f=i):(y=v,f=o),l.sort(h)},g._addAlgorithm((function(e,n,r){for(var o=e.key;y(o);)if(++p===l.length)return n(r),!1;return!!function(e){return!d(e)&&!v(e)}(o)||(0===t._cmp(o,l[p][1])||0===t._cmp(o,l[p][0])||n((function(){f===i?e.continue(l[p][0]):e.continue(l[p][1])})),!1)})),g},e.prototype.startsWithAnyOf=function(){var e=Zt.apply(Xt,arguments);return e.every((function(e){return"string"==typeof e}))?0===e.length?so(this):this.inAnyRange(e.map((function(e){return[e,e+Mi]}))):uo(this,"startsWithAnyOf() only works with strings")},e}();function vo(e){return 1===e.length?e[0]:e}function yo(e){try{return e.only([[]]),[[]]}catch(e){return Mi}}function go(e){return li((function(n){return mo(n),e(n.target.error),!1}))}function mo(e){e.stopPropagation&&e.stopPropagation(),e.preventDefault&&e.preventDefault()}var bo=function(){function e(){}return e.prototype._lock=function(){return Mt(!Wr.global),++this._reculock,1!==this._reculock||Wr.global||(Wr.lockOwnerFor=this),this},e.prototype._unlock=function(){if(Mt(!Wr.global),0==--this._reculock)for(Wr.global||(Wr.lockOwnerFor=null);this._blockedFuncs.length>0&&!this._locked();){var e=this._blockedFuncs.shift();try{Oi(e[1],e[0])}catch(e){}}return this},e.prototype._locked=function(){return this._reculock&&Wr.lockOwnerFor!==this},e.prototype.create=function(e){var n=this;if(!this.mode)return this;var t=this.db.idbdb,r=this.db._state.dbOpenError;if(Mt(!this.idbtrans),!e&&!t)switch(r&&r.name){case"DatabaseClosedError":throw new yr.DatabaseClosed(r);case"MissingAPIError":throw new yr.MissingAPI(r.message,r);default:throw new yr.OpenFailed(r)}if(!this.active)throw new yr.TransactionInactive;return Mt(null===this._completion._state),(e=this.idbtrans=e||t.transaction(vo(this.storeNames),this.mode)).onerror=li((function(t){mo(t),n._reject(e.error)})),e.onabort=li((function(t){mo(t),n.active&&n._reject(new yr.Abort(e.error)),n.active=!1,n.on("abort").fire(t)})),e.oncomplete=li((function(){n.active=!1,n._resolve()})),this},e.prototype._promise=function(e,n,t){var r=this;if("readwrite"===e&&"readwrite"!==this.mode)return Ii(new yr.ReadOnly("Transaction is readonly"));if(!this.active)return Ii(new yr.TransactionInactive);if(this._locked())return new Jr((function(i,o){r._blockedFuncs.push([function(){r._promise(e,n,t).then(i,o)},Wr])}));if(t)return gi((function(){var e=new Jr((function(e,t){r._lock();var i=n(e,t,r);i&&i.then&&i.then(e,t)}));return e.finally((function(){return r._unlock()})),e._lib=!0,e}));var i=new Jr((function(e,t){var i=n(e,t,r);i&&i.then&&i.then(e,t)}));return i._lib=!0,i},e.prototype._root=function(){return this.parent?this.parent._root():this},e.prototype.waitFor=function(e){var n=this._root(),t=Jr.resolve(e);if(n._waitingFor)n._waitingFor=n._waitingFor.then((function(){return t}));else{n._waitingFor=t,n._waitingQueue=[];var r=n.idbtrans.objectStore(n.storeNames[0]);!function e(){for(++n._spinCount;n._waitingQueue.length;)n._waitingQueue.shift()();n._waitingFor&&(r.get(-1/0).onsuccess=e)}()}var i=n._waitingFor;return new Jr((function(e,r){t.then((function(t){return n._waitingQueue.push(li(e.bind(null,t)))}),(function(e){return n._waitingQueue.push(li(r.bind(null,e)))})).finally((function(){n._waitingFor===i&&(n._waitingFor=null)}))}))},e.prototype.abort=function(){this.active&&this._reject(new yr.Abort),this.active=!1},e.prototype.table=function(e){var n=this._memoizedTables||(this._memoizedTables={});if(kt(n,e))return n[e];var t=this.schema[e];if(!t)throw new yr.NotFound("Table "+e+" not part of transaction");var r=new this.db.Table(e,t,this);return r.core=this.db.core.table(e),n[e]=r,r},e}();function wo(e,n,t,r,i,o,a){return{name:e,keyPath:n,unique:t,multi:r,auto:i,compound:o,src:(t&&!a?"&":"")+(r?"*":"")+(i?"++":"")+_o(n)}}function _o(e){return"string"==typeof e?e:e?"["+[].join.call(e,"+")+"]":""}function xo(e,n,t){return{name:e,primKey:n,indexes:t,mappedClass:null,idxByName:Kt(t,(function(e){return[e.name,e]}))}}function ko(e){return null==e?function(){}:"string"==typeof e?function(e){return 1===e.split(".").length?function(n){return n[e]}:function(n){return Dt(n,e)}}(e):function(n){return Dt(n,e)}}function So(e,n){return"delete"===n.type?n.keys:n.keys||n.values.map(e.extractKey)}function Oo(e){return[].slice.call(e)}var Co=0;function Eo(e){return null==e?":id":"string"==typeof e?e:"["+e.join("+")+"]"}function Ao(e,n,t,r){var i=n.cmp.bind(n);function o(e){if(3===e.type)return null;if(4===e.type)throw new Error("Cannot convert never type to IDBKeyRange");var n=e.lower,r=e.upper,i=e.lowerOpen,o=e.upperOpen;return void 0===n?void 0===r?null:t.upperBound(r,!!o):void 0===r?t.lowerBound(n,!!i):t.bound(n,r,!!i,!!o)}var a=function(e,n){var t=Oo(e.objectStoreNames);return{schema:{name:e.name,tables:t.map((function(e){return n.objectStore(e)})).map((function(e){var n=e.keyPath,t=e.autoIncrement,r=mt(n),i=null==n,o={},a={name:e.name,primaryKey:{name:null,isPrimaryKey:!0,outbound:i,compound:r,keyPath:n,autoIncrement:t,unique:!0,extractKey:ko(n)},indexes:Oo(e.indexNames).map((function(n){return e.index(n)})).map((function(e){var n=e.name,t=e.unique,r=e.multiEntry,i=e.keyPath,a={name:n,compound:mt(i),keyPath:i,unique:t,multiEntry:r,extractKey:ko(i)};return o[Eo(i)]=a,a})),getIndexByKeyPath:function(e){return o[Eo(e)]}};return o[":id"]=a.primaryKey,null!=n&&(o[Eo(n)]=a.primaryKey),a}))},hasGetAll:t.length>0&&"getAll"in n.objectStore(t[0])&&!("undefined"!=typeof navigator&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604)}}(e,r),u=a.schema,s=a.hasGetAll,c=u.tables.map((function(e){return function(e){var n=e.name;return{name:n,schema:e,mutate:function(t){var r=t.trans,i=t.type,a=t.keys,u=t.values,s=t.range,c=t.wantResults;return new Promise((function(t,l){t=li(t);var f=r.objectStore(n),h=null==f.keyPath,p="put"===i||"add"===i;if(!p&&"delete"!==i&&"deleteRange"!==i)throw new Error("Invalid operation type: "+i);var d=(a||u||{length:1}).length;if(a&&u&&a.length!==u.length)throw new Error("Given keys array must have same length as given values array.");if(0===d)return t({numFailures:0,failures:{},results:[],lastResult:void 0});var v,y=c&&yt(a||So(e.primaryKey,{type:i,keys:a,values:u})),g=[],m=0,b=function(e){++m,mo(e),y&&(y[e.target._reqno]=void 0),g[e.target._reqno]=e.target.error},w=function(e){var n=e.target;y[n._reqno]=n.result};if("deleteRange"===i){if(4===s.type)return t({numFailures:m,failures:g,results:y,lastResult:void 0});v=3===s.type?f.clear():f.delete(o(s))}else{var _=p?h?[u,a]:[u,null]:[a,null],x=_[0],k=_[1];if(p)for(var S=0;S<d;++S)(v=k&&void 0!==k[S]?f[i](x[S],k[S]):f[i](x[S]))._reqno=S,y&&void 0===y[S]&&(v.onsuccess=w),v.onerror=b;else for(S=0;S<d;++S)(v=f[i](x[S]))._reqno=S,v.onerror=b}var O=function(e){var n=e.target.result;y&&(y[d-1]=n),t({numFailures:m,failures:g,results:y,lastResult:n})};v.onerror=function(e){b(e),O(e)},v.onsuccess=O}))},getMany:function(e){var t=e.trans,r=e.keys;return new Promise((function(e,i){e=li(e);for(var o,a=t.objectStore(n),u=r.length,s=new Array(u),c=0,l=0,f=function(n){var t=n.target;s[t._pos]=t.result,++l===c&&e(s)},h=go(i),p=0;p<u;++p)null!=r[p]&&((o=a.get(r[p]))._pos=p,o.onsuccess=f,o.onerror=h,++c);0===c&&e(s)}))},get:function(e){var t=e.trans,r=e.key;return new Promise((function(e,i){e=li(e);var o=t.objectStore(n).get(r);o.onsuccess=function(n){return e(n.target.result)},o.onerror=go(i)}))},query:function(e){return function(t){return new Promise((function(r,i){r=li(r);var a=t.trans,u=t.values,s=t.limit,c=t.query,l=s===1/0?void 0:s,f=c.index,h=c.range,p=a.objectStore(n),d=f.isPrimaryKey?p:p.index(f.name),v=o(h);if(0===s)return r({result:[]});if(e){var y=u?d.getAll(v,l):d.getAllKeys(v,l);y.onsuccess=function(e){return r({result:e.target.result})},y.onerror=go(i)}else{var g=0,m=u||!("openKeyCursor"in d)?d.openCursor(v):d.openKeyCursor(v),b=[];m.onsuccess=function(e){var n=m.result;return n?(b.push(u?n.value:n.primaryKey),++g===s?r({result:b}):void n.continue()):r({result:b})},m.onerror=go(i)}}))}}(s),openCursor:function(e){var t=e.trans,r=e.values,i=e.query,a=e.reverse,u=e.unique;return new Promise((function(e,s){e=li(e);var c=i.index,l=i.range,f=t.objectStore(n),h=c.isPrimaryKey?f:f.index(c.name),p=a?u?"prevunique":"prev":u?"nextunique":"next",d=r||!("openKeyCursor"in h)?h.openCursor(o(l),p):h.openKeyCursor(o(l),p);d.onerror=go(s),d.onsuccess=li((function(n){var r=d.result;if(r){r.___id=++Co,r.done=!1;var i=r.continue.bind(r),o=r.continuePrimaryKey;o&&(o=o.bind(r));var a=r.advance.bind(r),u=function(){throw new Error("Cursor not stopped")};r.trans=t,r.stop=r.continue=r.continuePrimaryKey=r.advance=function(){throw new Error("Cursor not started")},r.fail=li(s),r.next=function(){var e=this,n=1;return this.start((function(){return n--?e.continue():e.stop()})).then((function(){return e}))},r.start=function(e){var n=new Promise((function(e,n){e=li(e),d.onerror=go(n),r.fail=n,r.stop=function(n){r.stop=r.continue=r.continuePrimaryKey=r.advance=u,e(n)}})),t=function(){if(d.result)try{e()}catch(e){r.fail(e)}else r.done=!0,r.start=function(){throw new Error("Cursor behind last entry")},r.stop()};return d.onsuccess=li((function(e){d.onsuccess=t,t()})),r.continue=i,r.continuePrimaryKey=o,r.advance=a,t(),n},e(r)}else e(null)}),s)}))},count:function(e){var t=e.query,r=e.trans,i=t.index,a=t.range;return new Promise((function(e,t){var u=r.objectStore(n),s=i.isPrimaryKey?u:u.index(i.name),c=o(a),l=c?s.count(c):s.count();l.onsuccess=li((function(n){return e(n.target.result)})),l.onerror=go(t)}))}}}(e)})),l={};return c.forEach((function(e){return l[e.name]=e})),{stack:"dbcore",transaction:e.transaction.bind(e),table:function(e){if(!l[e])throw new Error("Table '"+e+"' not found");return l[e]},cmp:i,MIN_KEY:-1/0,MAX_KEY:yo(t),schema:u}}function jo(e,n,t,r){var i=t.IDBKeyRange;return{dbcore:function(e,n){return n.reduce((function(e,n){var t=n.create;return vt(vt({},e),t(e))}),e)}(Ao(n,t.indexedDB,i,r),e.dbcore)}}function Po(e,n){var t=n.db,r=jo(e._middlewares,t,e._deps,n);e.core=r.dbcore,e.tables.forEach((function(n){var t=n.name;e.core.schema.tables.some((function(e){return e.name===t}))&&(n.core=e.core.table(t),e[t]instanceof e.Table&&(e[t].core=n.core))}))}function Io(e,n,t,r){t.forEach((function(t){var i=r[t];n.forEach((function(n){var r=jt(n,t);(!r||"value"in r&&void 0===r.value)&&(n===e.Transaction.prototype||n instanceof e.Transaction?Ct(n,t,{get:function(){return this.table(t)},set:function(e){Ot(this,t,{value:e,writable:!0,configurable:!0,enumerable:!0})}}):n[t]=new e.Table(t,i))}))}))}function To(e,n){n.forEach((function(n){for(var t in n)n[t]instanceof e.Table&&delete n[t]}))}function Mo(e,n){return e._cfg.version-n._cfg.version}function Ro(e,n,t,r){var i=e._dbSchema,o=e._createTransaction("readwrite",e._storeNames,i);o.create(t),o._completion.catch(r);var a=o._reject.bind(o),u=Wr.transless||Wr;gi((function(){Wr.trans=o,Wr.transless=u,0===n?(gt(i).forEach((function(e){Do(t,e,i[e].primKey,i[e].indexes)})),Po(e,t),Jr.follow((function(){return e.on.populate.fire(o)})).catch(a)):function(e,n,t,r){var i=[],o=e._versions,a=e._dbSchema=No(e,e.idbdb,r),u=!1;function s(){return i.length?Jr.resolve(i.shift()(t.idbtrans)).then(s):Jr.resolve()}return o.filter((function(e){return e._cfg.version>=n})).forEach((function(o){i.push((function(){var i=a,s=o._cfg.dbschema;zo(e,i,r),zo(e,s,r),a=e._dbSchema=s;var c=Ko(i,s);c.add.forEach((function(e){Do(r,e[0],e[1].primKey,e[1].indexes)})),c.change.forEach((function(e){if(e.recreate)throw new yr.Upgrade("Not yet support for changing primary key");var n=r.objectStore(e.name);e.add.forEach((function(e){return Fo(n,e)})),e.change.forEach((function(e){n.deleteIndex(e.name),Fo(n,e)})),e.del.forEach((function(e){return n.deleteIndex(e)}))}));var l=o._cfg.contentUpgrade;if(l&&o._cfg.version>n){Po(e,r),t._memoizedTables={},u=!0;var f=zt(s);c.del.forEach((function(e){f[e]=i[e]})),To(e,[e.Transaction.prototype]),Io(e,[e.Transaction.prototype],gt(f),f),t.schema=f;var h,p=er(l);p&&mi();var d=Jr.follow((function(){if((h=l(t))&&p){var e=bi.bind(null,null);h.then(e,e)}}));return h&&"function"==typeof h.then?Jr.resolve(h):d.then((function(){return h}))}})),i.push((function(n){u&&zi||function(e,n){for(var t=0;t<n.db.objectStoreNames.length;++t){var r=n.db.objectStoreNames[t];null==e[r]&&n.db.deleteObjectStore(r)}}(o._cfg.dbschema,n);To(e,[e.Transaction.prototype]),Io(e,[e.Transaction.prototype],e._storeNames,e._dbSchema),t.schema=e._dbSchema}))})),s().then((function(){var e,n;n=r,gt(e=a).forEach((function(t){n.db.objectStoreNames.contains(t)||Do(n,t,e[t].primKey,e[t].indexes)}))}))}(e,n,o,t).catch(a)}))}function Ko(e,n){var t,r={del:[],add:[],change:[]};for(t in e)n[t]||r.del.push(t);for(t in n){var i=e[t],o=n[t];if(i){var a={name:t,def:o,recreate:!1,del:[],add:[],change:[]};if(""+(i.primKey.keyPath||"")!=""+(o.primKey.keyPath||"")||i.primKey.auto!==o.primKey.auto&&!Ni)a.recreate=!0,r.change.push(a);else{var u=i.idxByName,s=o.idxByName,c=void 0;for(c in u)s[c]||a.del.push(c);for(c in s){var l=u[c],f=s[c];l?l.src!==f.src&&a.change.push(f):a.add.push(f)}(a.del.length>0||a.add.length>0||a.change.length>0)&&r.change.push(a)}}else r.add.push([t,o])}return r}function Do(e,n,t,r){var i=e.db.createObjectStore(n,t.keyPath?{keyPath:t.keyPath,autoIncrement:t.auto}:{autoIncrement:t.auto});return r.forEach((function(e){return Fo(i,e)})),i}function Fo(e,n){e.createIndex(n.name,n.keyPath,{unique:n.unique,multiEntry:n.multi})}function No(e,n,t){var r={};return It(n.objectStoreNames,0).forEach((function(e){for(var n=t.objectStore(e),i=n.keyPath,o=wo(_o(i),i||"",!1,!1,!!n.autoIncrement,i&&"string"!=typeof i,!0),a=[],u=0;u<n.indexNames.length;++u){var s=n.index(n.indexNames[u]);i=s.keyPath;var c=wo(s.name,i,!!s.unique,!!s.multiEntry,!1,i&&"string"!=typeof i,!1);a.push(c)}r[e]=xo(e,o,a)})),r}function zo(e,n,t){for(var r=t.db.objectStoreNames,i=0;i<r.length;++i){var o=r[i],a=t.objectStore(o);e._hasGetAll="getAll"in a;for(var u=0;u<a.indexNames.length;++u){var s=a.indexNames[u],c=a.index(s).keyPath,l="string"==typeof c?c:"["+It(c).join("+")+"]";if(n[o]){var f=n[o].idxByName[l];f&&(f.name=s,delete n[o].idxByName[l],n[o].idxByName[s]=f)}}}"undefined"!=typeof navigator&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&bt.WorkerGlobalScope&&bt instanceof bt.WorkerGlobalScope&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604&&(e._hasGetAll=!1)}var Lo,Bo=function(){function e(){}return e.prototype._parseStoresSpec=function(e,n){gt(e).forEach((function(t){if(null!==e[t]){var r=e[t].split(",").map((function(e,n){var t=(e=e.trim()).replace(/([&*]|\+\+)/g,""),r=/^\[/.test(t)?t.match(/^\[(.*)\]$/)[1].split("+"):t;return wo(t,r||null,/\&/.test(e),/\*/.test(e),/\+\+/.test(e),mt(r),0===n)})),i=r.shift();if(i.multi)throw new yr.Schema("Primary key cannot be multi-valued");r.forEach((function(e){if(e.auto)throw new yr.Schema("Only primary key can be marked as autoIncrement (++)");if(!e.keyPath)throw new yr.Schema("Index must have a name and cannot be an empty string")})),n[t]=xo(t,i,r)}}))},e.prototype.stores=function(e){var n=this.db;this._cfg.storesSource=this._cfg.storesSource?wt(this._cfg.storesSource,e):e;var t=n._versions,r={},i={};return t.forEach((function(e){wt(r,e._cfg.storesSource),i=e._cfg.dbschema={},e._parseStoresSpec(r,i)})),n._dbSchema=i,To(n,[n._allTables,n,n.Transaction.prototype]),Io(n,[n._allTables,n,n.Transaction.prototype,this._cfg.tables],gt(i),i),n._storeNames=gt(i),this},e.prototype.upgrade=function(e){return this._cfg.contentUpgrade=e,this},e}();function qo(e){return gi((function(){return Wr.letThrough=!0,e()}))}function Ho(e){var n=e._state,t=e._deps.indexedDB;if(n.isBeingOpened||e.idbdb)return n.dbReadyPromise.then((function(){return n.dbOpenError?Ii(n.dbOpenError):e}));nr&&(n.openCanceller._stackHolder=or()),n.isBeingOpened=!0,n.dbOpenError=null,n.openComplete=!1;var r=n.dbReadyResolve,i=null;return Jr.race([n.openCanceller,new Jr((function(r,o){if(!t)throw new yr.MissingAPI("indexedDB API not found. If using IE10+, make sure to run your code on a server URL (not locally). If using old Safari versions, make sure to include indexedDB polyfill.");var a=e.name,u=n.autoSchema?t.open(a):t.open(a,Math.round(10*e.verno));if(!u)throw new yr.MissingAPI("IndexedDB API not available");u.onerror=go(o),u.onblocked=li(e._fireOnBlocked),u.onupgradeneeded=li((function(r){if(i=u.transaction,n.autoSchema&&!e._options.allowEmptyDB){u.onerror=mo,i.abort(),u.result.close();var s=t.deleteDatabase(a);s.onsuccess=s.onerror=li((function(){o(new yr.NoSuchDatabase("Database "+a+" doesnt exist"))}))}else{i.onerror=go(o);var c=r.oldVersion>Math.pow(2,62)?0:r.oldVersion;e.idbdb=u.result,Ro(e,c/10,i,o)}}),o),u.onsuccess=li((function(){i=null;var t=e.idbdb=u.result,o=It(t.objectStoreNames);if(o.length>0)try{var s=t.transaction(vo(o),"readonly");n.autoSchema?function(e,n,t){e.verno=n.version/10;var r=e._dbSchema=No(0,n,t);e._storeNames=It(n.objectStoreNames,0),Io(e,[e._allTables],gt(r),r)}(e,t,s):(zo(e,e._dbSchema,s),function(e,n){var t=Ko(No(0,e.idbdb,n),e._dbSchema);return!(t.add.length||t.change.some((function(e){return e.add.length||e.change.length})))}(e,s)||console.warn("Dexie SchemaDiff: Schema was extended without increasing the number passed to db.version(). Some queries may fail.")),Po(e,s)}catch(e){}Fi.push(e),t.onversionchange=li((function(t){n.vcFired=!0,e.on("versionchange").fire(t)})),Lo.add(a),r()}),o)}))]).then((function(){return n.onReadyBeingFired=[],Jr.resolve(qo(e.on.ready.fire)).then((function e(){if(n.onReadyBeingFired.length>0){var t=n.onReadyBeingFired.reduce(Er,br);return n.onReadyBeingFired=[],Jr.resolve(qo(t)).then(e)}}))})).finally((function(){n.onReadyBeingFired=null})).then((function(){return n.isBeingOpened=!1,e})).catch((function(t){try{i&&i.abort()}catch(e){}return n.isBeingOpened=!1,e.close(),n.dbOpenError=t,Ii(n.dbOpenError)})).finally((function(){n.openComplete=!0,r()}))}function Uo(e){var n=function(n){return e.next(n)},t=i(n),r=i((function(n){return e.throw(n)}));function i(e){return function(n){var i=e(n),o=i.value;return i.done?o:o&&"function"==typeof o.then?o.then(t,r):mt(o)?Promise.all(o).then(t,r):t(o)}}return i(n)()}function $o(e,n,t){var r=arguments.length;if(r<2)throw new yr.InvalidArgument("Too few arguments");for(var i=new Array(r-1);--r;)i[r-1]=arguments[r];t=i.pop();var o=Bt(i);return[e,o,t]}function Wo(e,n,t,r,i){return Jr.resolve().then((function(){var o=Wr.transless||Wr,a=e._createTransaction(n,t,e._dbSchema,r),u={trans:a,transless:o};r?a.idbtrans=r.idbtrans:a.create();var s,c=er(i);c&&mi();var l=Jr.follow((function(){if(s=i.call(a,a))if(c){var e=bi.bind(null,null);s.then(e,e)}else"function"==typeof s.next&&"function"==typeof s.throw&&(s=Uo(s))}),u);return(s&&"function"==typeof s.then?Jr.resolve(s).then((function(e){return a.active?e:Ii(new yr.PrematureCommit("Transaction committed too early. See http://bit.ly/2kdckMn"))})):l.then((function(){return s}))).then((function(e){return r&&a._resolve(),a._completion.then((function(){return e}))})).catch((function(e){return a._reject(e),Ii(e)}))}))}function Vo(e,n,t){for(var r=mt(e)?e.slice():[e],i=0;i<t;++i)r.push(n);return r}var Yo={stack:"dbcore",name:"VirtualIndexMiddleware",level:1,create:function(e){return vt(vt({},e),{table:function(n){var t=e.table(n),r=t.schema,i={},o=[];function a(e,n,t){var r=Eo(e),u=i[r]=i[r]||[],s=null==e?0:"string"==typeof e?1:e.length,c=n>0,l=vt(vt({},t),{isVirtual:c,isPrimaryKey:!c&&t.isPrimaryKey,keyTail:n,keyLength:s,extractKey:ko(e),unique:!c&&t.unique});(u.push(l),l.isPrimaryKey||o.push(l),s>1)&&a(2===s?e[0]:e.slice(0,s-1),n+1,t);return u.sort((function(e,n){return e.keyTail-n.keyTail})),l}var u=a(r.primaryKey.keyPath,0,r.primaryKey);i[":id"]=[u];for(var s=0,c=r.indexes;s<c.length;s++){var l=c[s];a(l.keyPath,0,l)}function f(n){var t,r,i=n.query.index;return i.isVirtual?vt(vt({},n),{query:{index:i,range:(t=n.query.range,r=i.keyTail,{type:1===t.type?2:t.type,lower:Vo(t.lower,t.lowerOpen?e.MAX_KEY:e.MIN_KEY,r),lowerOpen:!0,upper:Vo(t.upper,t.upperOpen?e.MIN_KEY:e.MAX_KEY,r),upperOpen:!0})}}):n}return vt(vt({},t),{schema:vt(vt({},r),{primaryKey:u,indexes:o,getIndexByKeyPath:function(e){var n=i[Eo(e)];return n&&n[0]}}),count:function(e){return t.count(f(e))},query:function(e){return t.query(f(e))},openCursor:function(n){var r=n.query.index,i=r.keyTail,o=r.isVirtual,a=r.keyLength;if(!o)return t.openCursor(n);return t.openCursor(f(n)).then((function(t){return t&&function(t){return Object.create(t,{continue:{value:function(r){null!=r?t.continue(Vo(r,n.reverse?e.MAX_KEY:e.MIN_KEY,i)):n.unique?t.continue(Vo(t.key,n.reverse?e.MIN_KEY:e.MAX_KEY,i)):t.continue()}},continuePrimaryKey:{value:function(n,r){t.continuePrimaryKey(Vo(n,e.MAX_KEY,i),r)}},key:{get:function(){var e=t.key;return 1===a?e[0]:e.slice(0,a)}},value:{get:function(){return t.value}}})}(t)}))}})}})}},Go={stack:"dbcore",name:"HooksMiddleware",level:2,create:function(e){return vt(vt({},e),{table:function(n){var t=e.table(n),r=t.schema.primaryKey;return vt(vt({},t),{mutate:function(e){var i=Wr.trans,o=i.table(n).hook,a=o.deleting,u=o.creating,s=o.updating;switch(e.type){case"add":if(u.fire===br)break;return i._promise("readwrite",(function(){return c(e)}),!0);case"put":if(u.fire===br&&s.fire===br)break;return i._promise("readwrite",(function(){return c(e)}),!0);case"delete":if(a.fire===br)break;return i._promise("readwrite",(function(){return c(e)}),!0);case"deleteRange":if(a.fire===br)break;return i._promise("readwrite",(function(){return function(e){return function e(n,i,o){return t.query({trans:n,values:!1,query:{index:r,range:i},limit:o}).then((function(t){var r=t.result;return c({type:"delete",keys:r,trans:n}).then((function(t){return t.numFailures>0?Promise.reject(t.failures[0]):r.length<o?{failures:[],numFailures:0,lastResult:void 0}:e(n,vt(vt({},i),{lower:r[r.length-1],lowerOpen:!0}),o)}))}))}(e.trans,e.range,1e4)}(e)}),!0)}return t.mutate(e);function c(e){var n=Wr.trans,i=e.keys||So(r,e);if(!i)throw new Error("Keys missing");return"delete"!==(e="add"===e.type||"put"===e.type?vt(vt({},e),{keys:i,wantResults:!0}):vt({},e)).type&&(e.values=yt(e.values)),e.keys&&(e.keys=yt(e.keys)),function(e,n,t){return"add"===n.type?Promise.resolve(new Array(n.values.length)):e.getMany({trans:n.trans,keys:t})}(t,e,i).then((function(o){var c=i.map((function(t,i){var c=o[i],l={onerror:null,onsuccess:null};if("delete"===e.type)a.fire.call(l,t,c,n);else if("add"===e.type||void 0===c){var f=u.fire.call(l,t,e.values[i],n);null==t&&null!=f&&(t=f,e.keys[i]=t,r.outbound||Ft(e.values[i],r.keyPath,t))}else{var h=Gt(c,e.values[i]),p=s.fire.call(l,h,t,c,n);if(p){var d=e.values[i];Object.keys(p).forEach((function(e){kt(d,e)?d[e]=p[e]:Ft(d,e,p[e])}))}}return l}));return t.mutate(e).then((function(n){for(var t=n.failures,r=n.results,a=n.numFailures,u=n.lastResult,s=0;s<i.length;++s){var l=r?r[s]:i[s],f=c[s];null==l?f.onerror&&f.onerror(t[s]):f.onsuccess&&f.onsuccess("put"===e.type&&o[s]?e.values[s]:l)}return{failures:t,results:r,numFailures:a,lastResult:u}})).catch((function(e){return c.forEach((function(n){return n.onerror&&n.onerror(e)})),Promise.reject(e)}))}))}}})}})}},Jo=function(){function e(n,t){var r=this;this._middlewares={},this.verno=0;var i=e.dependencies;this._options=t=vt({addons:e.addons,autoOpen:!0,indexedDB:i.indexedDB,IDBKeyRange:i.IDBKeyRange},t),this._deps={indexedDB:t.indexedDB,IDBKeyRange:t.IDBKeyRange};var o=t.addons;this._dbSchema={},this._versions=[],this._storeNames=[],this._allTables={},this.idbdb=null;var a,u={dbOpenError:null,isBeingOpened:!1,onReadyBeingFired:null,openComplete:!1,dbReadyResolve:br,dbReadyPromise:null,cancelOpen:br,openCanceller:null,autoSchema:!0};u.dbReadyPromise=new Jr((function(e){u.dbReadyResolve=e})),u.openCanceller=new Jr((function(e,n){u.cancelOpen=n})),this._state=u,this.name=n,this.on=Gi(this,"populate","blocked","versionchange",{ready:[Er,br]}),this.on.ready.subscribe=Tt(this.on.ready.subscribe,(function(n){return function(t,i){e.vip((function(){var e=r._state;if(e.openComplete)e.dbOpenError||Jr.resolve().then(t),i&&n(t);else if(e.onReadyBeingFired)e.onReadyBeingFired.push(t),i&&n(t);else{n(t);var o=r;i||n((function e(){o.on.ready.unsubscribe(t),o.on.ready.unsubscribe(e)}))}}))}})),this.Collection=(a=this,Ji(io.prototype,(function(e,n){this.db=a;var t=Wi,r=null;if(n)try{t=n()}catch(e){r=e}var i=e._ctx,o=i.table,u=o.hook.reading.fire;this._ctx={table:o,index:i.index,isPrimKey:!i.index||o.schema.primKey.keyPath&&i.index===o.schema.primKey.name,range:t,keysOnly:!1,dir:"next",unique:"",algorithm:null,filter:null,replayFilter:null,justLimit:!0,isMatch:null,offset:0,limit:1/0,error:r,or:i.or,valueMapper:u!==wr?u:null}}))),this.Table=function(e){return Ji(Yi.prototype,(function(n,t,r){this.db=e,this._tx=r,this.name=n,this.schema=t,this.hook=e._allTables[n]?e._allTables[n].hook:Gi(null,{creating:[kr,br],reading:[_r,wr],updating:[Or,br],deleting:[Sr,br]})}))}(this),this.Transaction=function(e){return Ji(bo.prototype,(function(n,t,r,i){var o=this;this.db=e,this.mode=n,this.storeNames=t,this.schema=r,this.idbtrans=null,this.on=Gi(this,"complete","error","abort"),this.parent=i||null,this.active=!0,this._reculock=0,this._blockedFuncs=[],this._resolve=null,this._reject=null,this._waitingFor=null,this._waitingQueue=null,this._spinCount=0,this._completion=new Jr((function(e,n){o._resolve=e,o._reject=n})),this._completion.then((function(){o.active=!1,o.on.complete.fire()}),(function(e){var n=o.active;return o.active=!1,o.on.error.fire(e),o.parent?o.parent._reject(e):n&&o.idbtrans&&o.idbtrans.abort(),Ii(e)}))}))}(this),this.Version=function(e){return Ji(Bo.prototype,(function(n){this.db=e,this._cfg={version:n,storesSource:null,dbschema:{},tables:{},contentUpgrade:null}}))}(this),this.WhereClause=function(e){return Ji(po.prototype,(function(n,t,r){this.db=e,this._ctx={table:n,index:":id"===t?null:t,or:r};var i=e._deps.indexedDB;if(!i)throw new yr.MissingAPI("indexedDB API missing");this._cmp=this._ascending=i.cmp.bind(i),this._descending=function(e,n){return i.cmp(n,e)},this._max=function(e,n){return i.cmp(e,n)>0?e:n},this._min=function(e,n){return i.cmp(e,n)<0?e:n},this._IDBKeyRange=e._deps.IDBKeyRange}))}(this),this.on("versionchange",(function(e){e.newVersion>0?console.warn("Another connection wants to upgrade database '"+r.name+"'. Closing db now to resume the upgrade."):console.warn("Another connection wants to delete database '"+r.name+"'. Closing db now to resume the delete request."),r.close()})),this.on("blocked",(function(e){!e.newVersion||e.newVersion<e.oldVersion?console.warn("Dexie.delete('"+r.name+"') was blocked"):console.warn("Upgrade '"+r.name+"' blocked by other connection holding version "+e.oldVersion/10)})),this._maxKey=yo(t.IDBKeyRange),this._createTransaction=function(e,n,t,i){return new r.Transaction(e,n,t,i)},this._fireOnBlocked=function(e){r.on("blocked").fire(e),Fi.filter((function(e){return e.name===r.name&&e!==r&&!e._state.vcFired})).map((function(n){return n.on("versionchange").fire(e)}))},this.use(Yo),this.use(Go),o.forEach((function(e){return e(r)}))}return e.prototype.version=function(e){if(isNaN(e)||e<.1)throw new yr.Type("Given version is not a positive number");if(e=Math.round(10*e)/10,this.idbdb||this._state.isBeingOpened)throw new yr.Schema("Cannot add version when database is open");this.verno=Math.max(this.verno,e);var n=this._versions,t=n.filter((function(n){return n._cfg.version===e}))[0];return t||(t=new this.Version(e),n.push(t),n.sort(Mo),t.stores({}),this._state.autoSchema=!1,t)},e.prototype._whenReady=function(e){var n=this;return this._state.openComplete||Wr.letThrough?e():new Jr((function(e,t){if(!n._state.isBeingOpened){if(!n._options.autoOpen)return void t(new yr.DatabaseClosed);n.open().catch(br)}n._state.dbReadyPromise.then(e,t)})).then(e)},e.prototype.use=function(e){var n=e.stack,t=e.create,r=e.level,i=e.name;i&&this.unuse({stack:n,name:i});var o=this._middlewares[n]||(this._middlewares[n]=[]);return o.push({stack:n,create:t,level:null==r?10:r,name:i}),o.sort((function(e,n){return e.level-n.level})),this},e.prototype.unuse=function(e){var n=e.stack,t=e.name,r=e.create;return n&&this._middlewares[n]&&(this._middlewares[n]=this._middlewares[n].filter((function(e){return r?e.create!==r:!!t&&e.name!==t}))),this},e.prototype.open=function(){return Ho(this)},e.prototype.close=function(){var e=Fi.indexOf(this),n=this._state;if(e>=0&&Fi.splice(e,1),this.idbdb){try{this.idbdb.close()}catch(e){}this.idbdb=null}this._options.autoOpen=!1,n.dbOpenError=new yr.DatabaseClosed,n.isBeingOpened&&n.cancelOpen(n.dbOpenError),n.dbReadyPromise=new Jr((function(e){n.dbReadyResolve=e})),n.openCanceller=new Jr((function(e,t){n.cancelOpen=t}))},e.prototype.delete=function(){var e=this,n=arguments.length>0,t=this._state;return new Jr((function(r,i){var o=function(){e.close();var n=e._deps.indexedDB.deleteDatabase(e.name);n.onsuccess=li((function(){Lo.remove(e.name),r()})),n.onerror=go(i),n.onblocked=e._fireOnBlocked};if(n)throw new yr.InvalidArgument("Arguments not allowed in db.delete()");t.isBeingOpened?t.dbReadyPromise.then(o):o()}))},e.prototype.backendDB=function(){return this.idbdb},e.prototype.isOpen=function(){return null!==this.idbdb},e.prototype.hasBeenClosed=function(){var e=this._state.dbOpenError;return e&&"DatabaseClosed"===e.name},e.prototype.hasFailed=function(){return null!==this._state.dbOpenError},e.prototype.dynamicallyOpened=function(){return this._state.autoSchema},Object.defineProperty(e.prototype,"tables",{get:function(){var e=this;return gt(this._allTables).map((function(n){return e._allTables[n]}))},enumerable:!0,configurable:!0}),e.prototype.transaction=function(){var e=$o.apply(this,arguments);return this._transaction.apply(this,e)},e.prototype._transaction=function(e,n,t){var r=this,i=Wr.trans;i&&i.db===this&&-1===e.indexOf("!")||(i=null);var o,a,u=-1!==e.indexOf("?");e=e.replace("!","").replace("?","");try{if(a=n.map((function(e){var n=e instanceof r.Table?e.name:e;if("string"!=typeof n)throw new TypeError("Invalid table argument to Dexie.transaction(). Only Table or String are allowed");return n})),"r"==e||e===Hi)o=Hi;else{if("rw"!=e&&e!=Ui)throw new yr.InvalidArgument("Invalid transaction mode: "+e);o=Ui}if(i){if(i.mode===Hi&&o===Ui){if(!u)throw new yr.SubTransaction("Cannot enter a sub-transaction with READWRITE mode when parent transaction is READONLY");i=null}i&&a.forEach((function(e){if(i&&-1===i.storeNames.indexOf(e)){if(!u)throw new yr.SubTransaction("Table "+e+" not included in parent transaction.");i=null}})),u&&i&&!i.active&&(i=null)}}catch(e){return i?i._promise(null,(function(n,t){t(e)})):Ii(e)}var s=Wo.bind(null,this,o,a,i,t);return i?i._promise(o,s,"lock"):Wr.trans?Oi(Wr.transless,(function(){return r._whenReady(s)})):this._whenReady(s)},e.prototype.table=function(e){if(!kt(this._allTables,e))throw new yr.InvalidTable("Table "+e+" does not exist");return this._allTables[e]},e}(),Qo=Jo;St(Qo,vt(vt({},mr),{delete:function(e){return new Qo(e).delete()},exists:function(e){return new Qo(e,{addons:[]}).open().then((function(e){return e.close(),!0})).catch("NoSuchDatabaseError",(function(){return!1}))},getDatabaseNames:function(e){return Lo?Lo.getDatabaseNames().then(e):Jr.resolve([])},defineClass:function(){return function(e){wt(this,e)}},ignoreTransaction:function(e){return Wr.trans?Oi(Wr.transless,e):e()},vip:qo,async:function(e){return function(){try{var n=Uo(e.apply(this,arguments));return n&&"function"==typeof n.then?n:Jr.resolve(n)}catch(e){return Ii(e)}}},spawn:function(e,n,t){try{var r=Uo(e.apply(t,n||[]));return r&&"function"==typeof r.then?r:Jr.resolve(r)}catch(e){return Ii(e)}},currentTransaction:{get:function(){return Wr.trans||null}},waitFor:function(e,n){var t=Jr.resolve("function"==typeof e?Qo.ignoreTransaction(e):e).timeout(n||6e4);return Wr.trans?Wr.trans.waitFor(t):t},Promise:Jr,debug:{get:function(){return nr},set:function(e){tr(e,"dexie"===e?function(){return!0}:Bi)}},derive:Et,extend:wt,props:St,override:Tt,Events:Gi,getByKeyPath:Dt,setByKeyPath:Ft,delByKeyPath:Nt,shallowClone:zt,deepClone:$t,getObjectDiff:Gt,asap:Rt,minKey:Ri,addons:[],connections:Fi,errnames:dr,dependencies:function(){try{return{indexedDB:bt.indexedDB||bt.mozIndexedDB||bt.webkitIndexedDB||bt.msIndexedDB,IDBKeyRange:bt.IDBKeyRange||bt.webkitIDBKeyRange}}catch(e){return{indexedDB:null,IDBKeyRange:null}}}(),semVer:Ti,version:Ti.split(".").map((function(e){return parseInt(e)})).reduce((function(e,n,t){return e+n/Math.pow(10,2*t)})),default:Qo,Dexie:Qo})),Qo.maxKey=yo(Qo.dependencies.IDBKeyRange),function(e){try{Lo=function(e){var n,t=e&&"function"==typeof e.databases;if(!t){var r=new Jo(qi,{addons:[]});r.version(1).stores({dbnames:"name"}),n=r.table("dbnames")}return{getDatabaseNames:function(){return t?Jr.resolve(e.databases()).then((function(e){return e.map((function(e){return e.name})).filter((function(e){return e!==qi}))})):n.toCollection().primaryKeys()},add:function(e){return!t&&e!==qi&&n.put({name:e}).catch(br)},remove:function(e){return!t&&e!==qi&&n.delete(e).catch(br)}}}(e)}catch(e){}}(Jo.dependencies.indexedDB),Jr.rejectionMapper=function(e,n){if(!e||e instanceof lr||e instanceof TypeError||e instanceof SyntaxError||!e.name||!gr[e.name])return e;var t=new gr[e.name](n||e.message,e);return"stack"in e&&Ct(t,"stack",{get:function(){return this.inner.stack}}),t},tr(nr,Bi);const Xo=e=>e,Zo=e=>"number"==typeof e&&Number.isFinite(e),ea=e=>"string"==typeof e,na=Array.isArray,ta=e=>"object"==typeof e&&!!e&&!na(e),ra=(e,n)=>e>n,ia=(e,n)=>e<n,oa=(e,n,t)=>{let r,i;if(na(e))for(let o=0,a=e.length;o<a;o++){const a=n(e[o]);(void 0===i||t(a,i))&&(r=e[o],i=a)}return r},aa=(e,n)=>{const t=oa(e,n,ra);return void 0===t?t:n(t)},ua=e=>aa(e,Xo),sa=(e,n)=>oa(e,n,ia),ca=(e,n)=>e.reduce((e,t)=>e+n(t),0),la=(e,n)=>{const t={};for(let r=0,i=e.length;r<i;r++){const i=e[r],o=String(n(i));o in t||(t[o]=[]),t[o].push(e[r])}return t},fa=e=>0===e.length?[]:e.reduce((e,n)=>e.flatMap(e=>n.map(n=>[...e,n])),[[]]);function ha(e,n,t=Xo){if(e.length<=1)return e.slice();const r=[];let i=0,o=t(e[0]);for(let a=1,u=e.length;a<u;a++){const u=t(e[a]),s=o!==u?0:n(e[i],e[a],o);-1!==s&&(0===s&&r.push(e[i]),o=u,i=a)}return r.push(e[i]),r}const pa=(e,...n)=>{const t=new Map,[r,...i]=n;for(const[e,n]of r)t.set(e,n);for(const n of i)for(const[r,i]of n){const n=t.get(r);t.set(r,void 0===n?i:e(n,i))}return t},da=e=>"__duo-toolbox__-"+e,va=da("action_request"),ya=da("ui_event_notification");function ga(e,n=!0,t=!1){let r=t?e.normalize("NFD").replace(/\p{M}/gu,""):e;return r=r.normalize("NFC"),n?r.trim().replace(/(\s)\1+/g,"$1"):r}function ma(e){const n=e.match(/([\p{L}\p{N}]+)/gu);return n?Array.from(n):[]}const ba=e=>{const n=new Map;if(e.length<=2)n.set(e,(n.get(e)||0)+1);else for(let t=0,r=e.length-1;t<r;t++){const r=e.substring(t,t+2);n.set(r,(n.get(r)||0)+1)}return n},wa=["name","translate","completeReverseTranslation"],_a=["listen","listenTap"],xa=["name"],ka=["listenTap"];var Sa=n(t((function(e,n){!function(e){var n=Object.prototype.hasOwnProperty,t=function(e){for(var t,r=0;r<(arguments.length<=1?0:arguments.length-1);r++)if((t=r+1<1||arguments.length<=r+1?void 0:arguments[r+1])&&"object"==typeof t)for(var i in t)n.call(t,i)&&(e[i]=t[i]);return e},r=function(e){var n=e.length;if(!n)return[];if(1===n)return[e[0]];if(2===n)return[e[0],e[1]];if(3===n)return[e[0],e[1],e[2]];for(var t=new Array(n),r=0;r<n;r++)t[r]=e[r];return t},i=function(e,n){var t="function"==typeof n?n:function(e){return function(n,t){if(n.length!==t.length)return!1;for(var r=0,i=n.length;r<i;r++)if(!e(n[r],t[r]))return!1;return!0}}(e);return function(e,n){for(var r=0;r<e.length;r++)if(t(e[r],n))return r;return-1}},o=function(e,n){return e===n||e!=e&&n!=n},a=function(e,n,t){},u=function(e,n,t){for(var r=t;r--;)e[r+1]=e[r];e[0]=n},s=function(e){var n=i(e.isEqual,e.isMatchingKey);return function(t,r){var i=t.keys[0];t.values[0]=t.values[0].then((function(n){return e.onCacheHit(t,e,r),e.onCacheChange(t,e,r),n})).catch((function(e){var r=n(t.keys,i);throw~r&&(t.keys.splice(r,1),t.values.splice(r,1)),e}))}};function c(e,n){if(e.isMemoized)return e;var c=n||{},l=c.isEqual,f=void 0===l?o:l,h=c.isMatchingKey,p=c.isPromise,d=void 0!==p&&p,v=c.maxSize,y=void 0===v?1:v,g=c.onCacheAdd,m=void 0===g?a:g,b=c.onCacheChange,w=void 0===b?a:b,_=c.onCacheHit,x=void 0===_?a:_,k=c.transformKey,S=function(e,n){if(null==e)return{};var t,r,i={},o=Object.keys(e);for(r=0;r<o.length;r++)t=o[r],0<=n.indexOf(t)||(i[t]=e[t]);return i}(c,["isEqual","isMatchingKey","isPromise","maxSize","onCacheAdd","onCacheChange","onCacheHit","transformKey"]),O=t({},S,{isEqual:f,isMatchingKey:h,isPromise:d,maxSize:y,onCacheAdd:m,onCacheChange:w,onCacheHit:x,transformKey:k}),C=i(f,h),E=s(O),A=!(!k&&!h),j={keys:[],get size(){return j.keys.length},values:[]},P=j.keys,I=j.values;function T(){var n=arguments,t=A?r(n):n,i=k?k(t):t,o=C(P,i);if(~o)x(j,O,T),o&&(u(P,P[o],o),u(I,I[o],o),w(j,O,T));else{P.length>=y&&(P.pop(),I.pop());var a=A?i:r(t),s=e.apply(this,n);u(P,a,P.length),u(I,s,I.length),d&&E(j,T),m(j,O,T),w(j,O,T)}return I[0]}return Object.defineProperties(T,{cache:{configurable:!0,get:function(){return j}},cacheSnapshot:{configurable:!0,get:function(){return{keys:r(j.keys),size:j.size,values:r(j.values)}}},isMemoized:{configurable:!0,get:function(){return!0}},options:{configurable:!0,get:function(){return O}}}),T}function l(){for(var e=arguments.length,n=new Array(e),t=0;t<e;t++)n[t]=arguments[t];if(n.length)return n.reduce((function(e,n){return"function"==typeof e?"function"==typeof n?function(){return e(n.apply(this,arguments))}:e:"function"==typeof n?n:void 0}))}function f(e,n){for(var t=0;t<e.length;t++)if(e[t].key===n)return t;return-1}function h(e,n){var t="function"==typeof n?n:function(n,t){for(var r=0;r<t.length;r++)if(!e(n[r],t[r]))return!1;return!0};return function(e,n){for(var r=0;r<e.length;r++)if(e[r].length===n.length&&t(e[r],n))return r;return-1}}function p(e){return Array.isArray(e)?e:[e]}function d(e,n,t){var r=f(e,n);~r&&(clearTimeout(e[r].timeoutId),t&&e.splice(r,1))}function v(e,n){var t=setTimeout(e,n);return"function"==typeof t.unref&&t.unref(),t}function y(){D.isCollectingStats=!0}function g(e,n){return e?(n/e*100).toFixed(4)+"%":"0%"}function m(e){if(D.isCollectingStats||F||(console.warn('Stats are not currently being collected, please run "collectStats" to enable them.'),F=!0),e){if(!D.profiles[e])return{calls:0,hits:0,usage:"0%"};var n=D.profiles[e];return Object.assign({},n,{usage:g(n.calls,n.hits)})}var t=Object.keys(D.profiles).reduce((function(e,n){return e.calls+=D.profiles[n].calls,e.hits+=D.profiles[n].hits,e}),{calls:0,hits:0});return Object.assign({},t,{profiles:Object.keys(D.profiles).reduce((function(e,n){return e[n]=m(n),e}),{}),usage:g(t.calls,t.hits)})}function b(e,n){return e&&"object"==typeof e&&n.add(e)}function w(e,n,t,r){for(var i,o=0;o<e.length;o++)if(t((i=e[o])[0],n[0],r)&&t(i[1],n[1],r))return!0;return!1}function _(e,n,t,r){for(var i=0;i<e.length;i++)if(t(e[i],n,r))return!0;return!1}function x(e,n){return e===n||e!=e&&n!=n}function k(e){return e.constructor===Object}function S(e){return"function"==typeof e.then}function O(e){return!(!e.$$typeof||!e._store)}function C(e){return function(n){var t=e||n;return function(e,n,r){void 0===r&&(r=H?new WeakSet:Object.create({_values:[],add:function(e){this._values.push(e)},has:function(e){return!!~this._values.indexOf(e)}}));var i=r.has(e),o=r.has(n);return i||o?i&&o:(b(e,r),b(n,r),t(e,n,r))}}}function E(e){var n=[];return e.forEach((function(e,t){return n.push([t,e])})),n}function A(e){var n=[];return e.forEach((function(e){return n.push(e)})),n}function j(e,n,t,r){var i,o=U(e),a=U(n);if(o.length!==a.length)return!1;for(var u=0;u<o.length;u++){if(!_(a,i=o[u],x))return!1;if(!("_owner"===i&&O(e)&&O(n)||t(e[i],n[i],r)))return!1}return!0}function P(e){var n="function"==typeof e?e(t):t;function t(e,t,r){if(x(e,t))return!0;var i=typeof e;if(i!=typeof t||"object"!=i||!e||!t)return!1;if(k(e)&&k(t))return j(e,t,n,r);var o=$(e),a=$(t);if(o||a)return o===a&&function(e,n,t,r){if(e.length!==n.length)return!1;for(var i=0;i<e.length;i++)if(!t(e[i],n[i],r))return!1;return!0}(e,t,n,r);var u=e instanceof Date,s=t instanceof Date;if(u||s)return u==s&&x(e.getTime(),t.getTime());var c=e instanceof RegExp,l=t instanceof RegExp;if(c||l)return c==l&&function(e,n){return e.source===n.source&&e.global===n.global&&e.ignoreCase===n.ignoreCase&&e.multiline===n.multiline&&e.unicode===n.unicode&&e.sticky===n.sticky&&e.lastIndex===n.lastIndex}(e,t);if(S(e)||S(t))return e===t;if(B){var f=e instanceof Map,h=t instanceof Map;if(f||h)return f==h&&function(e,n,t,r){if(e.size!==n.size)return!1;for(var i=E(e),o=E(n),a=0;a<i.length;a++)if(!w(o,i[a],t,r)||!w(i,o[a],t,r))return!1;return!0}(e,t,n,r)}if(q){var p=e instanceof Set,d=t instanceof Set;if(p||d)return p==d&&function(e,n,t,r){if(e.size!==n.size)return!1;for(var i=A(e),o=A(n),a=0;a<i.length;a++)if(!_(o,i[a],t,r)||!_(i,o[a],t,r))return!1;return!0}(e,t,n,r)}return j(e,t,n,r)}return t}function I(e){return function(n){if(e>=n.length)return n;switch(e){case 0:return[];case 1:return[n[0]];case 2:return[n[0],n[1]];case 3:return[n[0],n[1],n[2]];case 4:return[n[0],n[1],n[2],n[3]];case 5:return[n[0],n[1],n[2],n[3],n[4]]}return Array.prototype.slice.call(n,0,e)}}var T={equals:void 0,isDeepEqual:!1,isPromise:!1,isReact:!1,isSerialized:!1,matchesKey:void 0,maxAge:void 0,maxArgs:void 0,maxSize:1/0,onExpire:void 0,profileName:void 0,serializer:void 0,shouldSerializeFunctions:!1,transformArgs:void 0,updateExpire:!1},M=function(){for(var e=arguments.length,n=new Array(e),t=0;t<e;t++)n[t]=arguments[t];if(n.length)return n.reduce((function(e,n){return"function"==typeof e?"function"==typeof n?function(){n.apply(this,arguments),e.apply(this,arguments)}:e:"function"==typeof n?n:void 0}))},R=function(e,n){return n===T?e:Object.assign({},e,n,{onCacheAdd:M(e.onCacheAdd,n.onCacheAdd),onCacheChange:M(e.onCacheChange,n.onCacheChange),onCacheHit:M(e.onCacheHit,n.onCacheHit),transformArgs:l(e.transformArgs,n.transformArgs)})},K=function(e,n,t,r){var i=n.maxAge,o=n.updateExpire,a="number"==typeof i&&isFinite(i)?function e(n,t,r,i){var o=t.maxAge,a=t.onCacheChange,u=t.onExpire,s=h(r,i);return function(i,c,l){var h=i.keys[0];if(!~f(n,h)){var p=function(){var o=s(i.keys,h),f=i.values[o];~o&&(i.keys.splice(o,1),i.values.splice(o,1),"function"==typeof a&&a(i,c,l)),d(n,h,!0),"function"==typeof u&&!1===u(h)&&(i.keys.unshift(h),i.values.unshift(f),e(n,t,r)(i,c,l),"function"==typeof a&&a(i,c,l))};n.push({expirationMethod:p,key:h,timeoutId:v(p,o)})}}}(e,n,t,r):void 0;return{onCacheAdd:a,onCacheHit:a&&o?function(e,n){var t=n.maxAge;return function(n){var r=n.keys[0],i=f(e,r);~i&&(d(e,r,!1),e[i].timeoutId=v(e[i].expirationMethod,t))}}(e,n):void 0}},D={anonymousProfileNameCounter:1,isCollectingStats:!1,profiles:{}},F=!1,N=function(e){var n=(new Error).stack,t=e.displayName||e.name||"Anonymous "+D.anonymousProfileNameCounter++;if(!n)return t;for(var r,i,o=n.split("\n").slice(3),a=0;a<o.length;a++)if(!~(r=o[a]).indexOf("/moize/")&&!~r.indexOf(" (native)")&&!~r.indexOf(" Function.")){i=r.replace(/\n/g,"\\n").trim();break}return i?t+" "+i:t},z=function(e){return D.isCollectingStats?{onCacheAdd:function(e){var n=e.profileName;return D.profiles[n]||(D.profiles[n]={calls:0,hits:0}),function(){D.profiles[n].calls++}}(e),onCacheHit:function(e){var n=e.profileName;return function(){D.profiles[n].calls++,D.profiles[n].hits++}}(e)}:{}},L=function(e,n){return function(e,n){var t=n.expirations,r=e.options,i=r.isEqual,o=r.isMatchingKey,a=r.onCacheAdd,s=r.onCacheChange,c=r.transformKey,l=h(i,o);e.add=function(n,t){var r=c?c(n):n;~l(e.cache.keys,r)||(e.cache.size>=e.options.maxSize&&(e.cache.keys.pop(),e.cache.values.pop()),e.cache.keys.unshift(r),e.cache.values.unshift(t),a(e.cache,e.options,e),s(e.cache,e.options,e))},e.clear=function(){e.cache.keys.length=0,e.cache.values.length=0,s(e.cache,e.options,e)},e.get=function(n){var t=l(e.cache.keys,c?c(n):n);return~t?e.apply(this,e.cache.keys[t]):void 0},e.getStats=function(){return m(e.options.profileName)},e.has=function(n){return!!~l(e.cache.keys,c?c(n):n)},e.keys=function(){return e.cacheSnapshot.keys},e.remove=function(n){var r=l(e.cache.keys,c?c(n):n);if(~r){var i=e.cache.keys[r];e.cache.keys.splice(r,1),e.cache.values.splice(r,1),s(e.cache,e.options,e),d(t,i,!0)}},e.update=function(n,t){var r=l(e.cache.keys,c?c(n):n);if(~r){var i=e.cache.keys[r];u(e.cache.keys,i,r),u(e.cache.values,t,r),s(e.cache,e.options,e)}},e.values=function(){return e.cacheSnapshot.values}}(e,n),function(e,n){var t=n.expirations,r=n.options,i=n.originalFunction,o=e.options;Object.defineProperties(e,{_microMemoizeOptions:{configurable:!0,get:function(){return o}},expirations:{configurable:!0,get:function(){return t}},expirationsSnapshot:{configurable:!0,get:function(){return t.slice(0)}},isCollectingStats:{configurable:!0,get:function(){return D.isCollectingStats}},isMoized:{configurable:!0,get:function(){return!0}},options:{configurable:!0,get:function(){return r}},originalFunction:{configurable:!0,get:function(){return i}}}),r.isReact&&(e.contextTypes=i.contextTypes,e.defaultProps=i.defaultProps,e.displayName="Moized("+(i.displayName||i.name||"Component")+")",e.propTypes=i.propTypes)}(e,n),e},B="function"==typeof Map,q="function"==typeof Set,H="function"==typeof WeakSet,U=Object.keys,$=Array.isArray,W=(P(C()),P(C(x)),P()),V=P((function(){return x}));function Y(e,n,t){return"[ref-"+t+"]"}var G=function(e,n){if(e[0]===n)return 0;for(var t=e.length,r=1;r<t;r++)if(e[r]===n)return r;return-1};function J(e,n){var t=n||Y,r="function"==typeof e,i=[];return function(n,o){if("object"==typeof o)if(i.length){var a=G(i,this)+1;a?i=function(e,n){for(var t=new Array(n),r=0;r<n;r++)t[r]=e[r];return t}(i,a):i[i.length]=this;var u=G(i,o);if(~u)return t.call(this,n,o,u)}else i[0]=o;return r?e.call(this,n,o):o}}function Q(e,n){return"function"==typeof n?""+n:n}function X(e,n){try{return JSON.stringify(e,n)}catch(t){return function(e,n,t,r){return JSON.stringify(e,J(n,r),t)}(e,n)}}function Z(e){return"function"==typeof e.serializer?l(p,e.serializer):function(e){var n=e.shouldSerializeFunctions?Q:null;return function(e){for(var t,r,i="|",o=0;o<e.length;o++)i+=(r=typeof(t=e[o]),(!t||"object"!=r&&"function"!=r?t:X(t,n))+"|");return[i]}}(e)}function ee(e,n){return e[0]===n[0]}var ne=function(e){if("function"==typeof e)return function(n,t,r){return e(r.cache,r.options,r)}},te=function(e){var n=e.equals,t=e.isDeepEqual,r=e.isReact;return n||t&&W||r&&V||x},re=function(e){var n=e.isSerialized;return e.matchesKey||n&&ee||void 0},ie=function(e){var n=e.maxArgs,t=e.isReact,r=e.isSerialized,i=e.transformArgs;return l(r&&Z(e),"function"==typeof i&&l(p,i),t&&I(2),"number"==typeof n&&I(n))};function oe(e,n){if(void 0===n&&(n=T),e.isMoized)return oe(e.originalFunction,R(e.options,n));if("object"==typeof e)return function(n,t){return void 0===t&&(t={}),"function"==typeof n?oe(n,R(e,t)):oe(R(e,n))};var t=Object.assign({},T,n,{maxArgs:"number"==typeof n.maxArgs&&0<=n.maxArgs?n.maxArgs:T.maxArgs,maxSize:"number"==typeof n.maxSize&&0<=n.maxSize?n.maxSize:T.maxSize,profileName:n.profileName||N(e)}),r=[],i=(t.equals,t.isDeepEqual,t.isPromise),o=(t.isReact,t.isSerialized,t.matchesKey,t.maxAge,t.maxArgs,t.maxSize),a=t.onCacheAdd,u=t.onCacheChange,s=t.onCacheHit,l=(t.onExpire,t.profileName,t.shouldSerializeFunctions,t.serializer,t.transformArgs,t.updateExpire,function(e,n){if(null==e)return{};var t,r,i={},o=Object.keys(e);for(r=0;r<o.length;r++)t=o[r],0<=n.indexOf(t)||(i[t]=e[t]);return i}(t,["equals","isDeepEqual","isPromise","isReact","isSerialized","matchesKey","maxAge","maxArgs","maxSize","onCacheAdd","onCacheChange","onCacheHit","onExpire","profileName","shouldSerializeFunctions","serializer","transformArgs","updateExpire"])),f=te(t),h=re(t),p=K(r,t,f,h),d=z(t),v=ie(t),y=Object.assign({},l,{isEqual:f,isMatchingKey:h,isPromise:i,maxSize:o,onCacheAdd:ne(M(a,p.onCacheAdd,d.onCacheAdd)),onCacheChange:ne(u),onCacheHit:ne(M(s,p.onCacheHit,d.onCacheHit)),transformKey:v});return L(c(e,y),{expirations:r,options:t,originalFunction:e})}oe.collectStats=y,oe.compose=function(){return l.apply(null,arguments)||oe},oe.deep=oe({isDeepEqual:!0}),oe.getStats=m,oe.isCollectingStats=function(){return D.isCollectingStats},oe.isMoized=function(e){return"function"==typeof e&&!!e.isMoized},oe.maxAge=function(e){return oe({maxAge:e})},oe.maxArgs=function(e){return oe({maxArgs:e})},oe.maxSize=function(e){return oe({maxSize:e})},oe.promise=oe({isPromise:!0,updateExpire:!0}),oe.react=oe({isReact:!0}),oe.reactSimple=oe({isReact:!0,maxSize:1}),oe.serialize=oe({isSerialized:!0}),oe.simple=oe({maxSize:1}),e.collectStats=y,e.default=oe,Object.defineProperty(e,"__esModule",{value:!0})}(n)}))),Oa=n(t((function(e,n){
/*!

	 diff v4.0.1

	Software License Agreement (BSD License)

	Copyright (c) 2009-2015, Kevin Decker <kpdecker@gmail.com>

	All rights reserved.

	Redistribution and use of this software in source and binary forms, with or without modification,
	are permitted provided that the following conditions are met:

	* Redistributions of source code must retain the above
	  copyright notice, this list of conditions and the
	  following disclaimer.

	* Redistributions in binary form must reproduce the above
	  copyright notice, this list of conditions and the
	  following disclaimer in the documentation and/or other
	  materials provided with the distribution.

	* Neither the name of Kevin Decker nor the names of its
	  contributors may be used to endorse or promote products
	  derived from this software without specific prior
	  written permission.

	THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS" AND ANY EXPRESS OR
	IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND
	FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR
	CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL
	DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,
	DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER
	IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT
	OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
	@license
	*/
!function(e){function n(){}function t(e,n,t,r,i){for(var o=0,a=n.length,u=0,s=0;o<a;o++){var c=n[o];if(c.removed){if(c.value=e.join(r.slice(s,s+c.count)),s+=c.count,o&&n[o-1].added){var l=n[o-1];n[o-1]=n[o],n[o]=l}}else{if(!c.added&&i){var f=t.slice(u,u+c.count);f=f.map((function(e,n){var t=r[s+n];return t.length>e.length?t:e})),c.value=e.join(f)}else c.value=e.join(t.slice(u,u+c.count));u+=c.count,c.added||(s+=c.count)}}var h=n[a-1];return a>1&&"string"==typeof h.value&&(h.added||h.removed)&&e.equals("",h.value)&&(n[a-2].value+=h.value,n.pop()),n}function r(e){return{newPos:e.newPos,components:e.components.slice(0)}}n.prototype={diff:function(e,n){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},o=i.callback;"function"==typeof i&&(o=i,i={}),this.options=i;var a=this;function u(e){return o?(setTimeout((function(){o(void 0,e)}),0),!0):e}e=this.castInput(e),n=this.castInput(n),e=this.removeEmpty(this.tokenize(e));var s=(n=this.removeEmpty(this.tokenize(n))).length,c=e.length,l=1,f=s+c,h=[{newPos:-1,components:[]}],p=this.extractCommon(h[0],n,e,0);if(h[0].newPos+1>=s&&p+1>=c)return u([{value:this.join(n),count:n.length}]);function d(){for(var i=-1*l;i<=l;i+=2){var o=void 0,f=h[i-1],p=h[i+1],d=(p?p.newPos:0)-i;f&&(h[i-1]=void 0);var v=f&&f.newPos+1<s,y=p&&0<=d&&d<c;if(v||y){if(!v||y&&f.newPos<p.newPos?(o=r(p),a.pushComponent(o.components,void 0,!0)):((o=f).newPos++,a.pushComponent(o.components,!0,void 0)),d=a.extractCommon(o,n,e,i),o.newPos+1>=s&&d+1>=c)return u(t(a,o.components,n,e,a.useLongestToken));h[i]=o}else h[i]=void 0}l++}if(o)!function e(){setTimeout((function(){if(l>f)return o();d()||e()}),0)}();else for(;l<=f;){var v=d();if(v)return v}},pushComponent:function(e,n,t){var r=e[e.length-1];r&&r.added===n&&r.removed===t?e[e.length-1]={count:r.count+1,added:n,removed:t}:e.push({count:1,added:n,removed:t})},extractCommon:function(e,n,t,r){for(var i=n.length,o=t.length,a=e.newPos,u=a-r,s=0;a+1<i&&u+1<o&&this.equals(n[a+1],t[u+1]);)a++,u++,s++;return s&&e.components.push({count:s}),e.newPos=a,u},equals:function(e,n){return this.options.comparator?this.options.comparator(e,n):e===n||this.options.ignoreCase&&e.toLowerCase()===n.toLowerCase()},removeEmpty:function(e){for(var n=[],t=0;t<e.length;t++)e[t]&&n.push(e[t]);return n},castInput:function(e){return e},tokenize:function(e){return e.split("")},join:function(e){return e.join("")}};var i=new n;function o(e,n,t){return i.diff(e,n,t)}function a(e,n){if("function"==typeof e)n.callback=e;else if(e)for(var t in e)e.hasOwnProperty(t)&&(n[t]=e[t]);return n}var u=/^[A-Za-z\xC0-\u02C6\u02C8-\u02D7\u02DE-\u02FF\u1E00-\u1EFF]+$/,s=/\S/,c=new n;function l(e,n,t){return t=a(t,{ignoreWhitespace:!0}),c.diff(e,n,t)}function f(e,n,t){return c.diff(e,n,t)}c.equals=function(e,n){return this.options.ignoreCase&&(e=e.toLowerCase(),n=n.toLowerCase()),e===n||this.options.ignoreWhitespace&&!s.test(e)&&!s.test(n)},c.tokenize=function(e){for(var n=e.split(/(\s+|[()[\]{}'"]|\b)/),t=0;t<n.length-1;t++)!n[t+1]&&n[t+2]&&u.test(n[t])&&u.test(n[t+2])&&(n[t]+=n[t+2],n.splice(t+1,2),t--);return n};var h=new n;function p(e,n,t){return h.diff(e,n,t)}function d(e,n,t){var r=a(t,{ignoreWhitespace:!0});return h.diff(e,n,r)}h.tokenize=function(e){var n=[],t=e.split(/(\n|\r\n)/);t[t.length-1]||t.pop();for(var r=0;r<t.length;r++){var i=t[r];r%2&&!this.options.newlineIsToken?n[n.length-1]+=i:(this.options.ignoreWhitespace&&(i=i.trim()),n.push(i))}return n};var v=new n;function y(e,n,t){return v.diff(e,n,t)}v.tokenize=function(e){return e.split(/(\S.+?[.!?])(?=\s+|$)/)};var g=new n;function m(e,n,t){return g.diff(e,n,t)}function b(e){return(b="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function w(e){return _(e)||x(e)||k()}function _(e){if(Array.isArray(e)){for(var n=0,t=new Array(e.length);n<e.length;n++)t[n]=e[n];return t}}function x(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}function k(){throw new TypeError("Invalid attempt to spread non-iterable instance")}g.tokenize=function(e){return e.split(/([{}:;,]|\s+)/)};var S=Object.prototype.toString,O=new n;function C(e,n,t){return O.diff(e,n,t)}function E(e,n,t,r,i){var o,a;for(n=n||[],t=t||[],r&&(e=r(i,e)),o=0;o<n.length;o+=1)if(n[o]===e)return t[o];if("[object Array]"===S.call(e)){for(n.push(e),a=new Array(e.length),t.push(a),o=0;o<e.length;o+=1)a[o]=E(e[o],n,t,r,i);return n.pop(),t.pop(),a}if(e&&e.toJSON&&(e=e.toJSON()),"object"===b(e)&&null!==e){n.push(e),a={},t.push(a);var u,s=[];for(u in e)e.hasOwnProperty(u)&&s.push(u);for(s.sort(),o=0;o<s.length;o+=1)a[u=s[o]]=E(e[u],n,t,r,u);n.pop(),t.pop()}else a=e;return a}O.useLongestToken=!0,O.tokenize=h.tokenize,O.castInput=function(e){var n=this.options,t=n.undefinedReplacement,r=n.stringifyReplacer,i=void 0===r?function(e,n){return void 0===n?t:n}:r;return"string"==typeof e?e:JSON.stringify(E(e,null,null,i),i,"  ")},O.equals=function(e,t){return n.prototype.equals.call(O,e.replace(/,([\r\n])/g,"$1"),t.replace(/,([\r\n])/g,"$1"))};var A=new n;function j(e,n,t){return A.diff(e,n,t)}function P(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},t=e.split(/\r\n|[\n\v\f\r\x85]/),r=e.match(/\r\n|[\n\v\f\r\x85]/g)||[],i=[],o=0;function a(){var e={};for(i.push(e);o<t.length;){var r=t[o];if(/^(\-\-\-|\+\+\+|@@)\s/.test(r))break;var a=/^(?:Index:|diff(?: -r \w+)+)\s+(.+?)\s*$/.exec(r);a&&(e.index=a[1]),o++}for(u(e),u(e),e.hunks=[];o<t.length;){var c=t[o];if(/^(Index:|diff|\-\-\-|\+\+\+)\s/.test(c))break;if(/^@@/.test(c))e.hunks.push(s());else{if(c&&n.strict)throw new Error("Unknown line "+(o+1)+" "+JSON.stringify(c));o++}}}function u(e){var n=/^(---|\+\+\+)\s+(.*)$/.exec(t[o]);if(n){var r="---"===n[1]?"old":"new",i=n[2].split("\t",2),a=i[0].replace(/\\\\/g,"\\");/^".*"$/.test(a)&&(a=a.substr(1,a.length-2)),e[r+"FileName"]=a,e[r+"Header"]=(i[1]||"").trim(),o++}}function s(){for(var e=o,i=t[o++].split(/@@ -(\d+)(?:,(\d+))? \+(\d+)(?:,(\d+))? @@/),a={oldStart:+i[1],oldLines:+i[2]||1,newStart:+i[3],newLines:+i[4]||1,lines:[],linedelimiters:[]},u=0,s=0;o<t.length&&!(0===t[o].indexOf("--- ")&&o+2<t.length&&0===t[o+1].indexOf("+++ ")&&0===t[o+2].indexOf("@@"));o++){var c=0==t[o].length&&o!=t.length-1?" ":t[o][0];if("+"!==c&&"-"!==c&&" "!==c&&"\\"!==c)break;a.lines.push(t[o]),a.linedelimiters.push(r[o]||"\n"),"+"===c?u++:"-"===c?s++:" "===c&&(u++,s++)}if(u||1!==a.newLines||(a.newLines=0),s||1!==a.oldLines||(a.oldLines=0),n.strict){if(u!==a.newLines)throw new Error("Added line count did not match for hunk at line "+(e+1));if(s!==a.oldLines)throw new Error("Removed line count did not match for hunk at line "+(e+1))}return a}for(;o<t.length;)a();return i}function I(e,n,t){var r=!0,i=!1,o=!1,a=1;return function u(){if(r&&!o){if(i?a++:r=!1,e+a<=t)return a;o=!0}if(!i)return o||(r=!0),n<=e-a?-a++:(i=!0,u())}}function T(e,n){var t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if("string"==typeof n&&(n=P(n)),Array.isArray(n)){if(n.length>1)throw new Error("applyPatch only works with a single input.");n=n[0]}var r,i,o=e.split(/\r\n|[\n\v\f\r\x85]/),a=e.match(/\r\n|[\n\v\f\r\x85]/g)||[],u=n.hunks,s=t.compareLine||function(e,n,t,r){return n===r},c=0,l=t.fuzzFactor||0,f=0,h=0;function p(e,n){for(var t=0;t<e.lines.length;t++){var r=e.lines[t],i=r.length>0?r[0]:" ",a=r.length>0?r.substr(1):r;if(" "===i||"-"===i){if(!s(n+1,o[n],i,a)&&++c>l)return!1;n++}}return!0}for(var d=0;d<u.length;d++){for(var v=u[d],y=o.length-v.oldLines,g=0,m=h+v.oldStart-1,b=I(m,f,y);void 0!==g;g=b())if(p(v,m+g)){v.offset=h+=g;break}if(void 0===g)return!1;f=v.offset+v.oldStart+v.oldLines}for(var w=0,_=0;_<u.length;_++){var x=u[_],k=x.oldStart+x.offset+w-1;w+=x.newLines-x.oldLines,k<0&&(k=0);for(var S=0;S<x.lines.length;S++){var O=x.lines[S],C=O.length>0?O[0]:" ",E=O.length>0?O.substr(1):O,A=x.linedelimiters[S];if(" "===C)k++;else if("-"===C)o.splice(k,1),a.splice(k,1);else if("+"===C)o.splice(k,0,E),a.splice(k,0,A),k++;else if("\\"===C){var j=x.lines[S-1]?x.lines[S-1][0]:null;"+"===j?r=!0:"-"===j&&(i=!0)}}}if(r)for(;!o[o.length-1];)o.pop(),a.pop();else i&&(o.push(""),a.push("\n"));for(var T=0;T<o.length-1;T++)o[T]=o[T]+a[T];return o.join("")}function M(e,n){"string"==typeof e&&(e=P(e));var t=0;function r(){var i=e[t++];if(!i)return n.complete();n.loadFile(i,(function(e,t){if(e)return n.complete(e);var o=T(t,i,n);n.patched(i,o,(function(e){if(e)return n.complete(e);r()}))}))}r()}function R(e,n,t,r,i,o,a){a||(a={}),void 0===a.context&&(a.context=4);var u=p(t,r,a);function s(e){return e.map((function(e){return" "+e}))}u.push({value:"",lines:[]});for(var c=[],l=0,f=0,h=[],d=1,v=1,y=function(e){var n=u[e],i=n.lines||n.value.replace(/\n$/,"").split("\n");if(n.lines=i,n.added||n.removed){var o;if(!l){var p=u[e-1];l=d,f=v,p&&(h=a.context>0?s(p.lines.slice(-a.context)):[],l-=h.length,f-=h.length)}(o=h).push.apply(o,w(i.map((function(e){return(n.added?"+":"-")+e})))),n.added?v+=i.length:d+=i.length}else{if(l)if(i.length<=2*a.context&&e<u.length-2){var y;(y=h).push.apply(y,w(s(i)))}else{var g,m=Math.min(i.length,a.context);(g=h).push.apply(g,w(s(i.slice(0,m))));var b={oldStart:l,oldLines:d-l+m,newStart:f,newLines:v-f+m,lines:h};if(e>=u.length-2&&i.length<=a.context){var _=/\n$/.test(t),x=/\n$/.test(r),k=0==i.length&&h.length>b.oldLines;!_&&k&&h.splice(b.oldLines,0,"\\ No newline at end of file"),(_||k)&&x||h.push("\\ No newline at end of file")}c.push(b),l=0,f=0,h=[]}d+=i.length,v+=i.length}},g=0;g<u.length;g++)y(g);return{oldFileName:e,newFileName:n,oldHeader:i,newHeader:o,hunks:c}}function K(e,n,t,r,i,o,a){var u=R(e,n,t,r,i,o,a),s=[];e==n&&s.push("Index: "+e),s.push("==================================================================="),s.push("--- "+u.oldFileName+(void 0===u.oldHeader?"":"\t"+u.oldHeader)),s.push("+++ "+u.newFileName+(void 0===u.newHeader?"":"\t"+u.newHeader));for(var c=0;c<u.hunks.length;c++){var l=u.hunks[c];s.push("@@ -"+l.oldStart+","+l.oldLines+" +"+l.newStart+","+l.newLines+" @@"),s.push.apply(s,l.lines)}return s.join("\n")+"\n"}function D(e,n,t,r,i,o){return K(e,e,n,t,r,i,o)}function F(e,n){return e.length===n.length&&N(e,n)}function N(e,n){if(n.length>e.length)return!1;for(var t=0;t<n.length;t++)if(n[t]!==e[t])return!1;return!0}function z(e){var n=te(e.lines),t=n.oldLines,r=n.newLines;void 0!==t?e.oldLines=t:delete e.oldLines,void 0!==r?e.newLines=r:delete e.newLines}function L(e,n,t){e=B(e,t),n=B(n,t);var r={};(e.index||n.index)&&(r.index=e.index||n.index),(e.newFileName||n.newFileName)&&(q(e)?q(n)?(r.oldFileName=H(r,e.oldFileName,n.oldFileName),r.newFileName=H(r,e.newFileName,n.newFileName),r.oldHeader=H(r,e.oldHeader,n.oldHeader),r.newHeader=H(r,e.newHeader,n.newHeader)):(r.oldFileName=e.oldFileName,r.newFileName=e.newFileName,r.oldHeader=e.oldHeader,r.newHeader=e.newHeader):(r.oldFileName=n.oldFileName||e.oldFileName,r.newFileName=n.newFileName||e.newFileName,r.oldHeader=n.oldHeader||e.oldHeader,r.newHeader=n.newHeader||e.newHeader)),r.hunks=[];for(var i=0,o=0,a=0,u=0;i<e.hunks.length||o<n.hunks.length;){var s=e.hunks[i]||{oldStart:1/0},c=n.hunks[o]||{oldStart:1/0};if(U(s,c))r.hunks.push($(s,a)),i++,u+=s.newLines-s.oldLines;else if(U(c,s))r.hunks.push($(c,u)),o++,a+=c.newLines-c.oldLines;else{var l={oldStart:Math.min(s.oldStart,c.oldStart),oldLines:0,newStart:Math.min(s.newStart+a,c.oldStart+u),newLines:0,lines:[]};W(l,s.oldStart,s.lines,c.oldStart,c.lines),o++,i++,r.hunks.push(l)}}return r}function B(e,n){if("string"==typeof e){if(/^@@/m.test(e)||/^Index:/m.test(e))return P(e)[0];if(!n)throw new Error("Must provide a base reference or pass in a patch");return R(void 0,void 0,n,e)}return e}function q(e){return e.newFileName&&e.newFileName!==e.oldFileName}function H(e,n,t){return n===t?n:(e.conflict=!0,{mine:n,theirs:t})}function U(e,n){return e.oldStart<n.oldStart&&e.oldStart+e.oldLines<n.oldStart}function $(e,n){return{oldStart:e.oldStart,oldLines:e.oldLines,newStart:e.newStart+n,newLines:e.newLines,lines:e.lines}}function W(e,n,t,r,i){var o={offset:n,lines:t,index:0},a={offset:r,lines:i,index:0};for(J(e,o,a),J(e,a,o);o.index<o.lines.length&&a.index<a.lines.length;){var u=o.lines[o.index],s=a.lines[a.index];if("-"!==u[0]&&"+"!==u[0]||"-"!==s[0]&&"+"!==s[0])if("+"===u[0]&&" "===s[0]){var c;(c=e.lines).push.apply(c,w(X(o)))}else if("+"===s[0]&&" "===u[0]){var l;(l=e.lines).push.apply(l,w(X(a)))}else"-"===u[0]&&" "===s[0]?Y(e,o,a):"-"===s[0]&&" "===u[0]?Y(e,a,o,!0):u===s?(e.lines.push(u),o.index++,a.index++):G(e,X(o),X(a));else V(e,o,a)}Q(e,o),Q(e,a),z(e)}function V(e,n,t){var r=X(n),i=X(t);if(ee(r)&&ee(i)){var o,a;if(N(r,i)&&ne(t,r,r.length-i.length))return void(o=e.lines).push.apply(o,w(r));if(N(i,r)&&ne(n,i,i.length-r.length))return void(a=e.lines).push.apply(a,w(i))}else if(F(r,i)){var u;return void(u=e.lines).push.apply(u,w(r))}G(e,r,i)}function Y(e,n,t,r){var i,o=X(n),a=Z(t,o);a.merged?(i=e.lines).push.apply(i,w(a.merged)):G(e,r?a:o,r?o:a)}function G(e,n,t){e.conflict=!0,e.lines.push({conflict:!0,mine:n,theirs:t})}function J(e,n,t){for(;n.offset<t.offset&&n.index<n.lines.length;){var r=n.lines[n.index++];e.lines.push(r),n.offset++}}function Q(e,n){for(;n.index<n.lines.length;){var t=n.lines[n.index++];e.lines.push(t)}}function X(e){for(var n=[],t=e.lines[e.index][0];e.index<e.lines.length;){var r=e.lines[e.index];if("-"===t&&"+"===r[0]&&(t="+"),t!==r[0])break;n.push(r),e.index++}return n}function Z(e,n){for(var t=[],r=[],i=0,o=!1,a=!1;i<n.length&&e.index<e.lines.length;){var u=e.lines[e.index],s=n[i];if("+"===s[0])break;if(o=o||" "!==u[0],r.push(s),i++,"+"===u[0])for(a=!0;"+"===u[0];)t.push(u),u=e.lines[++e.index];s.substr(1)===u.substr(1)?(t.push(u),e.index++):a=!0}if("+"===(n[i]||"")[0]&&o&&(a=!0),a)return t;for(;i<n.length;)r.push(n[i++]);return{merged:r,changes:t}}function ee(e){return e.reduce((function(e,n){return e&&"-"===n[0]}),!0)}function ne(e,n,t){for(var r=0;r<t;r++){var i=n[n.length-t+r].substr(1);if(e.lines[e.index+r]!==" "+i)return!1}return e.index+=t,!0}function te(e){var n=0,t=0;return e.forEach((function(e){if("string"!=typeof e){var r=te(e.mine),i=te(e.theirs);void 0!==n&&(r.oldLines===i.oldLines?n+=r.oldLines:n=void 0),void 0!==t&&(r.newLines===i.newLines?t+=r.newLines:t=void 0)}else void 0===t||"+"!==e[0]&&" "!==e[0]||t++,void 0===n||"-"!==e[0]&&" "!==e[0]||n++})),{oldLines:n,newLines:t}}function re(e){for(var n,t,r=[],i=0;i<e.length;i++)t=(n=e[i]).added?1:n.removed?-1:0,r.push([t,n.value]);return r}function ie(e){for(var n=[],t=0;t<e.length;t++){var r=e[t];r.added?n.push("<ins>"):r.removed&&n.push("<del>"),n.push(oe(r.value)),r.added?n.push("</ins>"):r.removed&&n.push("</del>")}return n.join("")}function oe(e){var n=e;return n=(n=(n=(n=n.replace(/&/g,"&amp;")).replace(/</g,"&lt;")).replace(/>/g,"&gt;")).replace(/"/g,"&quot;")}A.tokenize=function(e){return e.slice()},A.join=A.removeEmpty=function(e){return e},e.Diff=n,e.diffChars=o,e.diffWords=l,e.diffWordsWithSpace=f,e.diffLines=p,e.diffTrimmedLines=d,e.diffSentences=y,e.diffCss=m,e.diffJson=C,e.diffArrays=j,e.structuredPatch=R,e.createTwoFilesPatch=K,e.createPatch=D,e.applyPatch=T,e.applyPatches=M,e.parsePatch=P,e.merge=L,e.convertChangesToDMP=re,e.convertChangesToXML=ie,e.canonicalize=E,Object.defineProperty(e,"__esModule",{value:!0})}(n)})));const Ca=e=>-1===["ja","zh","zs"].indexOf(e),Ea=Sa((function(e,n,t){return e.localeCompare(n,t,{ignorePunctuation:!0,numeric:!0,sensitivity:"accent",usage:"sort"})})),Aa=(e,n,t)=>{let r=e;var i;return t&&(r=r.filter(e=>!/[^\s]\s+[^\s]/.test(e))),"en"===n?r=r.filter(e=>1===e.length||-1===e.indexOf("&")||!/(^|[^&\s])&([^&\s]|$)/.test(e)):"fr"===n&&(r=r.filter(e=>"oÃ¹"===e||"OÃ¹"===e||-1===e.indexOf("Ã¹"))),r=r.filter(e=>!/i\u0307/.test(e)),"tr"!==n&&(r=r.filter(e=>-1===e.indexOf("Ä±"))),r.length>1&&(i=r.sort((e,t)=>Ea(e,t,n)),r=ha(i,()=>-1)),r.length>1&&(r=ha(r,(e,n,t)=>n===t?-1:e===t?1:0,e=>e.normalize("NFD").replace(/\p{M}/u,"").replace(/[^\p{L}\p{N}]/u,""))),r},ja=(e,n,t)=>{let r=Aa(e.map(e=>String(e.orig||e.lenient||"")),n,t);return{token:r,solutionBase:{reference:r[0]||"",isComplex:r.length>1}}},Pa={size:0},Ia=(e,n,t,r)=>{if(!e[n])return[];if(na(e[n].solutions))return e[n].solutions;let i=[];for(const o of Object.keys(e[n])){const a=Number(o),u=e[n][a],s=Ia(e,a,t,r),{token:c,solutionBase:l}=ja(u,t,r);if(s.length>0)for(const e of s)i.push({locale:t,reference:l.reference+e.reference,isComplex:l.isComplex||e.isComplex,tokens:0===c.length?e.tokens:{token:c,next:e.tokens,size:e.tokens.size+1}});else a===e.length-1&&(l.locale=t,l.tokens=0===c.length?Pa:{token:c,next:Pa,size:1},i.push(l))}return e[n].solutions=i,i},Ta=(e,n)=>e.filter(ea).map(e=>{const t=ga(e),r=t.split(/([\p{L}\p{N}]+)/gu).map(e=>[e]);return{locale:n,reference:t,tokens:r,isComplex:!1}}),Ma=Symbol("summary"),Ra=Sa((e,n)=>ma(ga(e,!0,!1).toLocaleLowerCase(n))),Ka=Sa((e,n)=>ma(ga(e,!0,!0).toLocaleLowerCase(n))),Da=(e,n,t)=>{const r=new Set,i=e.tokens.map(n=>n.map(e=>e.trim()).filter(e=>""!==e).map(n=>{const i=((e,n,t)=>t.ignoreDiacritics?Ka(e,n):Ra(e,n))(n,e.locale,t);return i.forEach(e=>r.add(e)),i})).filter(e=>e.length>0);e.matchingData={id:n,tokens:i,words:Array.from(r)}},Fa=(e,n,t)=>{var r;const i=ga((e=>{if(!e[Ma]){const n=Ca(e.locale)?"":" ";e[Ma]=e.tokens.reduce((e,t)=>e+(1===t.length?t[0]:`${n}[${n}${t.join(" / ")}${n}]${n}`),"")}return e[Ma]})(e),!0,t.ignoreDiacritics).toLocaleLowerCase(e.locale),o=(null===(r=/^[^\p{L}\p{N}]*(.*?)[^\p{L}\p{N}]*?$/gu.exec(i))||void 0===r?void 0:r[1])||i;e.matchingData={id:n,summary:o}},Na={charCount:0,wordCount:0,bigramMap:new Map},za=Symbol("word_stats"),La=e=>({charCount:e.length,wordCount:1,bigramMap:ba(e)}),Ba=e=>0===e.length?Na:{charCount:ca(e,e=>e.charCount),wordCount:ca(e,e=>e.wordCount),bigramMap:pa((e,n)=>e+n,...e.map(e=>e.bigramMap))},qa=(e,n,t)=>{const r=(e=>{if(!e.matchingData)return{shared:Na};if(!e[za]){const{false:n=[],true:t=[]}=la(e.matchingData.tokens,e=>e.length>1);e[za]={shared:Ba(n.flatMap(e=>e[0].map(e=>La(e))))};const r=t.map(e=>e.map(e=>Ba(e.map(e=>La(e)))));if(r.length>0){const n=fa(r);e[za].paths=n.map(Ba)}}return e[za]})(e),i=Ba(((e,n,t)=>ma(ga(e,!0,t.ignoreDiacritics).toLocaleLowerCase(n)))(n,e.locale,t).map(La)),o=i.charCount+r.shared.charCount,a=i.wordCount+r.shared.wordCount;let u=0;for(const[e,n]of i.bigramMap){const t=r.shared.bigramMap.get(e)||0;t>0&&(u+=Math.min(n,t),i.bigramMap.set(e,Math.max(0,n-t)))}return r.paths?r.paths.map(e=>{let n=0;for(const[t,r]of i.bigramMap){const i=e.bigramMap.get(t)||0;i>0&&(n+=Math.min(r,i))}const t=o+e.charCount,r=a+e.wordCount;return 2*(u+n)/(t-r)}):[2*u/(o-a)]},Ha={ru:{"Ñ":"Ðµ"}},Ua=(e,n)=>{const t=Ha[n],r=ga(e).toLocaleLowerCase(n);return ta(t)?r.replace(new RegExp(`(${Object.keys(t).join("|")})`,"g"),e=>t[e]):r},$a=(e,n)=>(e.type&n)>0,Wa=e=>{var n;return(null===(n=e.solutions[0])||void 0===n?void 0:n.locale)||null},Va=e=>{if(!ta(e.matchingData)){const n=Wa(e),t={ignoreDiacritics:!1,ignoreWordOrder:!0};if(e.matchingData={matchingOptions:t,locale:n},Ca(n)){const n=new Set;e.solutions.forEach((e,r)=>{Da(e,r,t);for(const t of e.matchingData.words)n.add(t)}),e.matchingData.words=Array.from(n)}else e.solutions.forEach((e,n)=>Fa(e,n,t))}},Ya=(e,n)=>{Va(e),""!==n&&e.matchingData.words&&e.solutions.forEach(t=>{t.score=((e,n,t)=>ua(qa(e,n,t)))(t,n,e.matchingData.matchingOptions)})},getUiChallengeSolutions=e=>{const n=ta(e.grader)?e.grader:{},t=ta(e.metadata)?e.metadata:{},r=String(e.targetLanguage||n.language||t.target_language||t.language||"").trim();return na(e.correctSolutions)&&xa.indexOf(e.type)>=0?Ta(e.correctSolutions,r):ta(n)&&na(n.vertices)&&n.vertices.length>0?((e,n,t)=>{let r=Ia(e.map(e=>la(e.filter(e=>{return!(n=e).auto&&"typo"!==n.type;var n}),e=>e.to)),0,n,t);for(const e of r){let n=0,t=e.tokens;const r=new Array(e.tokens.size);for(;t.token;)r[n++]=t.token,t=t.next;e.tokens=r}return r=Object.values(la(r,e=>e.reference)).flatMap(e=>e.length<=1?e:e.some(e=>e.isComplex)?e.filter(e=>e.isComplex):e.slice(-1)),r})(n.vertices,r,!!n.whitespaceDelimited):ea(e.prompt)&&""!==e.prompt&&_a.indexOf(e.type)>=0?Ta([e.prompt],r):na(e.correctTokens)&&ka.indexOf(e.type)>=0?((e,n)=>{const t=e.filter(ea),r=ga(t.join(" "));if(""!==r){const e=t.flatMap(e=>[[e],[" "]]);return e.pop(),[{locale:n,reference:r,tokens:e,isComplex:!1}]}return[]})(e.correctTokens,r):[]},Ga=e=>`[${e.join("+")}]`,Ja="comment_challenges",Qa="comment_discussions",Xa="discussion_challenges",Za="discussion_comments",eu="challenge",nu="comment_id",tu="discussion_id",ru="inverted_size",iu="last_access_at",ou="locale",au="user_reference",uu=Ga([tu,ou]),su=Ga([iu,ru]),cu=1048576,lu=new Jo("duolingo-solution-viewer");lu.version(1).stores({[Za]:[tu].join(","),[Ja]:[nu,ru,iu,su].join(",")}),lu.version(2).stores({[Qa]:[nu].join(","),[Xa]:[uu,su].join(",")}).upgrade(async()=>{for(await lu.table(Za).clear();;){const r=await lu.table(Ja).orderBy(":id").limit(200).toArray();if(0===r.length)break;const i=[],o=[],a=[];for(const u of r){const r=u.challenge.discussionId,s=(e=u.challenge,n=void 0,t=void 0,n=e.fromLanguage,t=Wa(e),n===t||"zh"===n&&"zs"===t||"zs"===n&&"zh"===t?e.toLanguage:e.fromLanguage),c={[nu]:u[nu],[tu]:r,[ou]:s};u[tu]=r,u.locale=s,i.push(u[nu]),delete u[nu],o.push(c),a.push(u)}await lu.table(Ja).bulkDelete(i),await lu.table(Qa).bulkPut(o),await lu.table(Xa).bulkPut(a)}var e,n,t}),lu.version(3).upgrade(async()=>{await lu.table(Qa).clear();let e=0;for(;;){const n=await lu.table(Xa).orderBy(":id").offset(e).limit(200).toArray();if(0===n.length)break;const t=[],r=[];for(const i of n)t.push([i[tu],i.locale]),$a(i.challenge,4)||(i.locale=Wa(i.challenge),r.push(i),++e);await lu.table(Xa).bulkDelete(t),await lu.table(Xa).bulkPut(r)}});const fu=()=>Math.floor((new Date).getTime()/1e3/60/30),hu=async(e,n)=>{try{await lu[e].put(n)}catch(r){var t;if("QuotaExceededError"===r.name||"QuotaExceededError"===(null===(t=r.inner)||void 0===t?void 0:t.name)){let t=0;const r=e=>(t+=cu-(e[ru]||cu),t>=cu),i=await lu.discussion_challenges.orderBy(su).until(r,!0).toArray().map(e=>[e[tu],e.locale]);await lu.discussion_challenges.bulkDelete(i),await lu[e].put(n)}}},pu=e=>{var n;return`${String((null===(n=e.tab)||void 0===n?void 0:n.id)||"global")}-${String(e.frameId||"main")}`},du=[],vu={},yu=async e=>{let n=await lu.comment_discussions.get(e);if(ta(n)){const t=[n[tu],n.locale];if(n=await lu.discussion_challenges.where(uu).equals(t).first(),ta(n)){try{await lu.discussion_challenges.update(t,{[iu]:fu()})}catch(e){}return{commentId:e,challenge:n.challenge,userReference:n.user_reference}}}throw new Error(`There is no challenge for comment #${e}.`)},gu=async e=>Promise.all(e.map(e=>(async e=>{if(!e.discussionId)return Promise.resolve();const n=JSON.stringify(e).length;if(n>cu)throw new Error(`The discussion #${e.discussionId} has a challenge whose serialized size exceeds the limit.`);await hu(Xa,{[tu]:e.discussionId,[ou]:Wa(e),[eu]:e,[ru]:cu-n,[iu]:fu()})})(e))),mu=async(e,n)=>{e.discussionId&&await lu.discussion_challenges.update([e.discussionId,Wa(e)],{[au]:n,[iu]:fu()})},bu=(e,n,t)=>na(du[e])?du[e].find(e=>$a(e,n)&&t(e)):null,wu=async(e,n,t,r)=>{du[e]=((e,n,t)=>e.map(e=>{const r=getUiChallengeSolutions(e);if(r.length>0){const i=ga(String(e.prompt||"")),o=String(e.sentenceDiscussionId||"").trim();if(""!==i&&wa.indexOf(e.type)>=0)return{type:xa.indexOf(e.type)>=0?3:1,statement:i,solutions:r,fromLanguage:n,toLanguage:t,discussionId:o};if(_a.indexOf(e.type)>=0&&""!==String(e.solutionTranslation||"").trim()){const a=ga(String(e.solutionTranslation)),u=String(e.tts||"").trim(),s=String(e.slowTts||"").trim();return{type:4,statement:i,solutions:r,fromLanguage:n,toLanguage:t,discussionId:o,solutionTranslation:a,ttsMediaUrl:u,slowTtsMediaUrl:s}}}}).filter(ta))(n,t,r),await gu(du[e].filter(e=>$a(e,1)))},_u=async(e,n,t)=>{if(ta(n)){let r,i=()=>!0;const o=ea(n.userAnswer)?ga(n.userAnswer):"";if(ea(n.solutionTranslation)){const e=ga(n.solutionTranslation);i=n=>e===n.solutionTranslation}if(r=((e,n,t)=>na(du[e])?du[e].filter(e=>$a(e,n)&&t(e)):[])(e,4,i),0===r.length)return;const a=vu[e];let u=1===r.length?r.pop():vu[e]&&r.find(e=>((e,n)=>!!e.ttsMediaUrl&&e.ttsMediaUrl===n.ttsMediaUrl||!!e.slowTtsMediaUrl&&e.slowTtsMediaUrl===n.slowTtsMediaUrl)(e,a));if(!ta(u))return;Ya(u,o);const s={challenge:u};if(""!==o&&"correct"===n.result){let e;const n=Wa(u),t=u.matchingData.matchingOptions;if(u.solutions.some(e=>"score"in e)){const n=aa(u.solutions,e=>e.score);e=u.solutions.filter(e=>n===e.score).flatMap(e=>((e,n,t)=>{if(!e.isComplex)return[e.reference];const r=e.tokens.length;if(0===r)return[];const i=qa(e,n,t),o=ua(i),a=[e.tokens[r-1].length,1];for(let n=r-2;n>=1;n--)a.unshift(a[0]*e.tokens[n].length);return i.map((n,t)=>{if(n<o)return null;let i=t,u="";for(let n=0;n<r;n++)if(1===e.tokens[n].length)u+=e.tokens[n][0];else{const t=Math.floor(i/a[n]);u+=e.tokens[n][t],i%=a[n]}return u}).filter(ea)})(e,o,t))}else e=u.solutions.flatMap(e=>fa(e.tokens.map(e=>e)).map(e=>e.join("")));const r=e.map(e=>((e,n,t)=>{const r=Oa.diffChars(Ua(e,t),Ua(n,t)).flatMap(e=>{const n=[];if(e.added=!!e.added,e.removed=!!e.removed,e.added||e.removed){const t=[...e.value.matchAll(/[\p{P}\p{Z}]+/gu)].reduce((t,r)=>(r.index>t&&n.push({added:e.added,removed:e.removed,value:e.value.substring(t,r.index),count:r.index-t}),n.push({added:e.added,removed:e.removed,ignorable:!0,value:r[0],count:r[0].length}),r.index+r[0].length),0);t>0&&t<e.value.length&&n.push({added:e.added,removed:e.removed,value:e.value.substring(t,e.length),count:e.value.length-t})}return 0===n.length&&n.push(e),n});if(!r.some(e=>(e.added||e.removed)&&!e.ignorable))return null;const{result:i}=r.reduce(({result:e,left:n,right:t},r)=>{if(r.added)return r.value=t.substring(0,r.value.length),e.push(r),{result:e,left:n,right:t.substring(r.value.length)};if(r.removed)return r.value=n.substring(0,r.value.length),e.push(r),{result:e,right:t,left:n.substring(r.value.length)};const i=n.substring(0,r.value.length),o=t.substring(0,r.value.length),a=Oa.diffChars(i,o);return a.forEach(e=>{e.added=!!e.added,e.removed=!!e.removed,(e.added||e.removed)&&(e.ignorable=!0)}),e.push(...a),{result:e,left:n.substring(r.value.length),right:t.substring(r.value.length)}},{result:[],left:e,right:n});return i})(e,o,n));if(r.every(e=>na(e))){const e=((e,n)=>{const t=sa(e,n);return void 0===t?t:n(t)})(r,e=>e.length);s.correctionDiff=sa(r.filter(n=>e===n.length),e=>ca(e,e=>!e.ignorable&&(e.added||e.removed)&&e.value.length||0))}}t(s)}},xu=async e=>{ta(e)&&Zo(e.commentId)&&e.commentId>0&&ea(e.discussionId)&&""!==e.discussionId&&ea(e.locale)&&""!==e.locale&&await(async(e,n,t)=>{await hu(Qa,{[nu]:e,[tu]:n,[ou]:t})})(e.commentId,e.discussionId,e.locale)};lu.open().then(()=>{var e;e=async(e,n,t,r)=>{switch(e){case"get_current_translation_challenge":await(async(e,n,t)=>{if(ta(n)&&ea(n.statement)&&na(du[e])){const r=ga(n.statement),i=ea(n.userAnswer)?ga(n.userAnswer):"";let o=bu(e,1,e=>r===e.statement);if(o||(o=bu(e,3,r.indexOf(e=>e.statement)>=0)),!ta(o))return;Ya(o,i),t(o),""!==i&&await mu(o,i)}})(pu(t),n,r);break;case"get_current_listening_challenge":await _u(pu(t),n,r);break;case"update_current_challenge_user_reference":await(async(e,n,t)=>{if(ta(n)&&ea(n.key)&&ea(n.userReference)&&""!==n.userReference.trim()){const r=n.userReference.trim(),i=bu(e,1,e=>(e=>e.discussionId||`_duo-sv_-${e.type}-${e.statement}`)(e)===n.key);ta(i)&&(await mu(i,r),Ya(i,r),t({challenge:i,userReference:r}))}})(pu(t),n,r);break;case"get_comment_challenge":await(async(e,n)=>{if(Zo(e)&&e>0){const t=await yu(e);ea(t.userReference)&&""!==t.userReference?Ya(t.challenge,t.userReference):Va(t.challenge),n(t)}})(n,r);break;case"update_comment_challenge_user_reference":await(async(e,n)=>{if(ta(e)&&Zo(e.commentId)&&e.commentId>0&&ea(e.userReference)&&""!==e.userReference.trim()){const t=e.userReference.trim(),{challenge:r}=await yu(e.commentId);await mu(r,t),Ya(r,t),n({challenge:r,userReference:t})}})(n,r)}},chrome.runtime.onMessage.addListener((n,t,r)=>{if(va===n.type){let i=!1;const o=e=>{i=!0,r({type:"success",value:e})},a=e=>{i=!0,r({type:"failure",error:e})};try{Promise.resolve(e(n.action,n.value,t,o,a)).then(()=>{if(!i)throw new Error(`Could not handle action request: "${n.action}".`)}).catch(e=>{i||a(e)})}catch(e){!i&&a(e)}return!0}}),(e=>{chrome.runtime.onMessage.addListener((n,t)=>{ya===n.type&&e(n.event,n.value,t)})})(async(e,n,t)=>{switch(e){case"session_loaded":await(async(e,n)=>{if(ta(n)){var t,r;const i=na(n.challenges)?n.challenges:[],o=na(n.adaptiveChallenges)?n.adaptiveChallenges:[],a=[n.metadata,null===(t=i[0])||void 0===t?void 0:t.metadata,null===(r=o[0])||void 0===r?void 0:r.metadata].find(e=>ta(e))||{};await wu(e,i.concat(o),String(a.ui_language||a.from_language||n.fromLanguage||"").trim(),String(a.language||a.learning_language||n.learningLanguage||"").trim())}})(pu(t),n);break;case"discussion_loaded":await xu(n);break;case"sound_played":((e,n)=>{if(ea(n)){const t=n.trim();if(""!==t){const n=bu(e,4,e=>t===e.ttsMediaUrl||t===e.slowTtsMediaUrl);ta(n)&&(vu[e]=n)}}})(pu(t),n)}})})}();
